(()=>{var e={1644:(e,t,a)=>{"use strict";a(5363),a(71);var o=a(8880),i=a(9592),n=a(3673);function l(e,t,a,o,i,l){const s=(0,n.up)("router-view");return(0,n.wg)(),(0,n.j4)(s)}const s=(0,n.aZ)({name:"App"});var r=a(4260);const c=(0,r.Z)(s,[["render",l]]),u=c;var d=a(4755),m=a(7083),p=a(9582);const b="中国科技云对象存储",h="CSTCloud Object Storage",f=[{path:"/",component:()=>Promise.all([a.e(736),a.e(304)]).then(a.bind(a,304)),meta:{title:b,title_en:h,requireLogin:!1}},{path:"/my",component:()=>Promise.all([a.e(736),a.e(420)]).then(a.bind(a,6420)),redirect:"/my/bucket",meta:{requireLogin:!0},children:[{path:"bucket",component:()=>Promise.all([a.e(736),a.e(96)]).then(a.bind(a,4096)),meta:{title:"存储桶-"+b,title_en:"Bucket-"+h}},{path:"bucket/file",component:()=>Promise.all([a.e(736),a.e(12)]).then(a.bind(a,3012)),meta:{title:"存储桶-"+b,title_en:"Bucket-"+h},props:!0},{path:"ftp",component:()=>a.e(47).then(a.bind(a,5047)),meta:{title:"FTP-"+b,title_en:"FTP-"+h}}]},{path:"/:catchAll(.*)*",component:()=>a.e(86).then(a.bind(a,3086))}],g=f;var v=a(9346);const y=(0,m.BC)((function({store:e}){const t=p.PO,a=(0,p.p7)({scrollBehavior:()=>({left:0,top:0}),routes:g,history:t("/front/")});return a.beforeEach(((t,a,o)=>{const i=e.state.account.items.isLogin;t.meta.requireLogin&&!i||!t.meta.requireLogin&&i&&o({path:"/my"}),t.meta.title&&("zh"===v.i18n.global.locale?document.title=t.meta.title:document.title=t.meta.title_en||t.meta.title),o()})),a}));async function k(e,t){const o="function"===typeof d["default"]?await(0,d["default"])({}):d["default"],{storeKey:n}=await Promise.resolve().then(a.bind(a,4755)),l="function"===typeof y?await y({store:o}):y;o.$router=l;const s=e(u);return s.use(i.Z,t),{app:s,store:o,storeKey:n,router:l}}var w=a(7989),_=a(4434),q=a(5151);const Z={config:{notify:{badgePosition:"top-right",multiLine:!1,position:"bottom",closeBtn:!0,timeout:5e3}},lang:w.Z,plugins:{Notify:_.Z,Dialog:q.Z}},x="/front/",W=/\/\//,C=e=>(x+e).replace(W,"/");async function S({app:e,router:t,store:a,storeKey:o},i){let n=!1;const l=e=>{try{return C(t.resolve(e).href)}catch(a){}return Object(e)===e?null:e},s=e=>{if(n=!0,"string"===typeof e&&/^https?:\/\//.test(e))return void(window.location.href=e);const t=l(e);null!==t&&(window.location.href=t)},r=window.location.href.replace(window.location.origin,"");for(let u=0;!1===n&&u<i.length;u++)try{await i[u]({app:e,router:t,store:a,ssrContext:null,redirect:s,urlPath:r,publicPath:x})}catch(c){return c&&c.url?void s(c.url):void console.error("[Quasar] boot error:",c)}!0!==n&&(e.use(t),e.use(a,o),e.mount("#q-app"))}k(o.ri,Z).then((e=>Promise.all([Promise.resolve().then(a.bind(a,9346)),Promise.resolve().then(a.bind(a,1768)),Promise.resolve().then(a.bind(a,9269))]).then((t=>{const a=t.map((e=>e.default)).filter((e=>"function"===typeof e));S(e,a)}))))},5487:(e,t,a)=>{"use strict";a.d(t,{Wh:()=>n});var o=a(7083),i=a(1768);i.$axiosHarbor.defaults.baseURL;const n={api:{postJwtRefresh(e){const t=e.body;return i.$axiosHarbor.post("/api/v1/jwt-refresh/",t)},postJwtVerify(e){const t=e.body;return i.$axiosHarbor.post("/api/v1/jwt-verify/",t)},postJwt(e){const t=e.body;return i.$axiosHarbor.post("/api/v1/jwt/",t)},postUsers(e){const t=e.body;return i.$axiosHarbor.post("/api/v1/users/",t)},patchUserName(e){const t=e.body;return i.$axiosHarbor.patch("/api/v1/users/"+e.path.username+"/",t)},deleteBucketToken(e){return i.$axiosHarbor["delete"]("/api/v1/bucket-token/"+e.path.token+"/")},getBuckets(e){const t={params:null===e||void 0===e?void 0:e.query};return i.$axiosHarbor.get("/api/v1/buckets/",t)},postBuckets(e){const t=e.body;return i.$axiosHarbor.post("/api/v1/buckets/",t)},postDirPath(e){return i.$axiosHarbor.post("/api/v1/dir/"+e.path.bucket_name+"/"+e.path.dirpath+"/")},deleteDirPath(e){return i.$axiosHarbor["delete"]("/api/v1/dir/"+e.path.bucket_name+"/"+e.path.dirpath+"/")},deleteObjPath(e){return i.$axiosHarbor["delete"]("/api/v1/obj/"+e.path.bucket_name+"/"+e.path.objpath+"/")},postObjPath(e){const t={params:null===e||void 0===e?void 0:e.query};return i.$axiosHarbor.post("/api/v1/move/"+e.path.bucket_name+"/"+e.path.objpath+"/",null,t)},putObjPath(e){return i.$axiosHarbor.put("/api/v1/obj/"+e.path.bucket_name+"/"+e.path.objpath+"/",e.body.file)},getObjPath(e){return i.$axiosHarbor.get("/share/obs/"+e.path.objpath,{responseType:"blob"})},patchDirPath(e){const t={params:e.query};return i.$axiosHarbor.patch("/api/v1/dir/"+e.path.bucket_name+"/"+e.path.dirpath+"/",null,t)},patchObjPath(e){const t={params:e.query};return i.$axiosHarbor.patch("/api/v1/obj/"+e.path.bucket_name+"/"+e.path.objpath+"/",null,t)},getPath(e){return i.$axiosHarbor.get("/api/v1/share/"+e.path.bucket_name+"/"+e.path.path)},patchBucketsIdOrName(e){const t={params:e.query};return i.$axiosHarbor.patch("/api/v1/buckets/"+e.path.id_or_name+"/",null,t)},deleteBucketsIdOrName(e){const t={params:e.query};return i.$axiosHarbor["delete"]("/api/v1/buckets/"+e.path.id_or_name+"/",t)},patchBucketsIdOrNameRemark(e){const t={params:e.query};return i.$axiosHarbor.patch("/api/v1/buckets/"+e.path.id_or_name+"/remark/",null,t)},postBucketsIdOrNameTokenCreate(e){const t={params:e.query};return i.$axiosHarbor.post("/api/v1/buckets/"+e.path.id_or_name+"/token/create/",null,t)},getBucketsIdOrNameTokenList(e){const t={params:null===e||void 0===e?void 0:e.query};return i.$axiosHarbor.get("/api/v1/buckets/"+e.path.id_or_name+"/token/list/",t)},getDirBucketName(e){const t={params:null===e||void 0===e?void 0:e.query};return i.$axiosHarbor.get("/api/v1/dir/"+e.path.bucket_name+"/",t)},getDirBucketNameDirPath(e){const t={params:null===e||void 0===e?void 0:e.query};return i.$axiosHarbor.get("/api/v1/dir/"+e.path.bucket_name+"/"+e.path.dirpath+"/",t)},patchFtpBucketName(e){const t={params:null===e||void 0===e?void 0:e.query};return i.$axiosHarbor.patch("/api/v1/ftp/"+e.path.bucket_name+"/",null,t)},getStatsBucket(e){return i.$axiosHarbor.get("/api/v1/stats/bucket/"+e.path.bucket_name+"/")}},share:{}};(0,o.xr)((({app:e})=>{e.config.globalProperties.$api=n}))},1768:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>d,$axios:()=>n.a,$axiosHarbor:()=>c});var o=a(7083),i=a(52),n=a.n(i),l=a(4434),s=a(5086),r=a.n(s);const c=n().create({baseURL:window.location.origin,paramsSerializer:function(e){return r().stringify(e,{arrayFormat:"comma"})}}),u=e=>{const t=new Map([[400,"请求错误"],[401,"认证失败"],[403,"拒绝访问"],[404,"请求地址出错"],[408,"请求超时"],[409,"请求冲突"],[500,"服务器内部错误"],[501,"服务未实现"],[502,"网关错误"],[503,"服务不可用"],[505,"HTTP版本不受支持"]]);if(e.response&&e.response.data){const a=e.response.status,o=t.get(a)||"";console.log("error status: ",a+"-"+o),console.log("error message: ",e.response.data.message),"BucketAlreadyOwnedByYou"!==e.response.data.code&&"BucketAlreadyExists"!==e.response.data.code&&l.Z.create({classes:"notification-negative shadow-15",icon:"mdi-alert",textColor:"negative",message:a+"-"+o,caption:e.response.data.message+e.response.data.code_text,position:"bottom",closeBtn:!0,timeout:5e3,multiLine:!1})}else console.log(e.message),l.Z.create({classes:"notification-negative shadow-15",icon:"mdi-alert",textColor:"negative",message:e.message,position:"bottom",closeBtn:!0,timeout:5e3,multiLine:!1})};n().interceptors.request.use((e=>e),(e=>(console.log("axios-REQ-Rejected"),u(e),Promise.reject(e)))),n().interceptors.response.use((e=>e),(e=>(console.log("axios-RESP-Rejected"),u(e),Promise.reject(e)))),c.interceptors.request.use((e=>e),(e=>(console.log("apiHarbor-REQ-Rejected"),u(e),Promise.reject(e)))),c.interceptors.response.use((e=>e),(e=>(console.log("apiHarbor-RESP-Rejected"),u(e),Promise.reject(e))));const d=(0,o.xr)((({app:e})=>{e.config.globalProperties.$axios=n(),e.config.globalProperties.$apiHarbor=c}))},9346:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>m,i18n:()=>d});var o=a(7083),i=a(5948),n=a(9592);const l={中文:"中文"},s={中文:"Chinese"},r={zh:l,en:s};var c;const u=null===(c=n.Z.lang.getLocale())||void 0===c?void 0:c.slice(0,2),d=(0,i.o)({locale:"zh"===u?"zh":"en",fallbackLocale:"zh",messages:r,silentFallbackWarn:!0}),m=(0,o.xr)((({app:e})=>{e.use(d),e.config.globalProperties.$i18n=d}))},9269:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});var o=a(7083),i=function(e,t,a,o){function i(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,n){function l(e){try{r(o.next(e))}catch(t){n(t)}}function s(e){try{r(o["throw"](e))}catch(t){n(t)}}function r(e){e.done?a(e.value):i(e.value).then(l,s)}r((o=o.apply(e,t||[])).next())}))};const n=(0,o.xr)((({store:e})=>i(void 0,void 0,void 0,(function*(){try{console.log(window.location.origin),yield e.dispatch("account/reloadToken"),yield e.dispatch("account/retainToken")}catch(t){console.log("Boot login error:",t)}}))))},4755:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>ra,storeKey:()=>sa,useStore:()=>ca});var o=a(7083),i=a(3617);function n(){return{items:{isLogin:!1}}}const l=n;var s=a(5487),r=a(1768),c=a(4434),u=a(51),d=function(e,t,a,o){function i(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,n){function l(e){try{r(o.next(e))}catch(t){n(t)}}function s(e){try{r(o["throw"](e))}catch(t){n(t)}}function r(e){e.done?a(e.value):i(e.value).then(l,s)}r((o=o.apply(e,t||[])).next())}))};const m={loginLocal(e,t){return d(this,void 0,void 0,(function*(){const a=yield s.Wh.api.postJwt({body:t});e.commit("storeUser",{access:a.data.access,refresh:a.data.refresh,loginType:"local"}),yield e.dispatch("retainToken"),this.$router.push({path:"/my"})}))},registerUser(e,t){return d(this,void 0,void 0,(function*(){yield s.Wh.api.postUsers({body:t})}))},changePassword(e,t){return d(this,void 0,void 0,(function*(){yield s.Wh.api.patchUserName({path:t.path,body:t.body})}))},reloadToken(e){return d(this,void 0,void 0,(function*(){if(localStorage.getItem("accessHarbor")&&localStorage.getItem("refreshHarbor")&&localStorage.getItem("loginTypeHarbor")){const a={access:localStorage.getItem("accessHarbor"),refresh:localStorage.getItem("refreshHarbor"),loginType:localStorage.getItem("loginTypeHarbor")};try{if(!(1e3*(0,u.Z)(a.access).exp-Date.now()>0))throw new Error("expired token");yield s.Wh.api.postJwtVerify({body:{token:a.access}}),e.commit("storeUser",a)}catch(t){console.log("reloadToken error",t),e.commit("deleteUser")}}}))},retainToken(e){if(e.state.items.access&&e.state.items.refresh&&e.state.items.loginType){const t=e.state.items.loginType,a=e.state.items.refresh,o=e.state.items.decoded;if(o.exp){const i=1e3*o.exp-Date.now()-5e3;console.log("retain timeout",i/1e3,"seconds"),setTimeout((()=>{(()=>{d(this,void 0,void 0,(function*(){try{if(e.state.items.access&&e.state.items.refresh&&e.state.items.loginType){delete r.$axios.defaults.headers.common.Authorization,delete r.$axiosHarbor.defaults.headers.common.Authorization;try{const o=yield s.Wh.api.postJwtRefresh({body:{refresh:a}});e.commit("storeUser",{access:o.data.access,refresh:a,loginType:t}),yield e.dispatch("retainToken")}catch(o){console.log(o),e.commit("deleteUser"),c.Z.create({classes:"notification-negative shadow-15",icon:"las la-exclamation-triangle",textColor:"negative",message:"登录状态失效，请重新登录"})}}}catch(o){console.log(o),e.commit("deleteUser")}}))})()}),i)}}}},p=m,b={someGetter(){}},h=b,f={storeUser(e,t){e.items.isLogin=!0,e.items.loginType=t.loginType,e.items.access=t.access,e.items.refresh=t.refresh,e.items.decoded=(0,u.Z)(t.access),localStorage.setItem("accessHarbor",e.items.access),localStorage.setItem("refreshHarbor",e.items.refresh),localStorage.setItem("loginTypeHarbor",e.items.loginType),r.$axios.defaults.headers.common.Authorization=`Bearer ${e.items.access}`,r.$axiosHarbor.defaults.headers.common.Authorization=`Bearer ${e.items.access}`},deleteUser(e){e.items.isLogin=!1,delete e.items.loginType,delete e.items.access,delete e.items.refresh,localStorage.removeItem("accessHarbor"),localStorage.removeItem("refreshHarbor"),localStorage.removeItem("loginTypeHarbor"),delete r.$axios.defaults.headers.common.Authorization,delete r.$axiosHarbor.defaults.headers.common.Authorization,this.$router.push("/")}},g=f,v={namespaced:!0,actions:p,getters:h,mutations:g,state:l},y=v;function k(){return{items:{},tables:{bucketTable:{type:"localId",byLocalId:{},allLocalIds:[],status:"empty"},bucketStatTable:{type:"localId",byLocalId:{},allLocalIds:[],status:"empty"},bucketTokenTable:{type:"localId",byLocalId:{},allLocalIds:[],status:"empty"},pathTable:{type:"localId",byLocalId:{},allLocalIds:[],status:"empty"}}}}const w=k;var _=a(5151),q=a(3673),Z=a(1959),x=a(2323),W=a(8880),C=a(4842),S=a(1701),j=a(52),I=a.n(j),T=function(e,t,a,o){function i(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,n){function l(e){try{r(o.next(e))}catch(t){n(t)}}function s(e){try{r(o["throw"](e))}catch(t){n(t)}}function r(e){e.done?a(e.value):i(e.value).then(l,s)}r((o=o.apply(e,t||[])).next())}))};const H={class:"text-primary"},Q={class:"row q-pb-lg items-center"},D=(0,q._)("div",{class:"col-2 text-grey-7"}," 存储桶名称 ",-1),P={class:"col"},O=(0,q._)("div",{class:"row q-pb-lg items-start"},[(0,q._)("div",{class:"col-2 text-grey-7"}," 名称规则 "),(0,q._)("div",{class:"col"}," 长度介于3-63个字符之间，可输入小写英文字母、数字或者-（连字符），但-（连字符）不允许在开头和结尾 ")],-1),B=(0,q.aZ)({emits:[...S.Z.emits],setup(e){const t=ca(),{dialogRef:a,onDialogHide:o,onDialogOK:i,onDialogCancel:n}=(0,S.Z)(),l=()=>T(this,void 0,void 0,(function*(){var e,a;if(u.value.length<3||u.value.length>64)c.Z.create({classes:"notification-negative shadow-15",icon:"las la-times-circle",textColor:"negative",message:"桶名称长度应为3-63个字符",position:"bottom",closeBtn:!0,timeout:5e3,multiLine:!1});else{d.value.$props.loading=!0,c.Z.create({classes:"notification-positive shadow-15",icon:"las la-redo-alt",textColor:"positive",message:"正在创建存储桶："+u.value,position:"bottom",closeBtn:!0,timeout:5e3,multiLine:!1});try{const e=yield s.Wh.api.postBuckets({body:{name:u.value}});t.commit("obs/storeItem",{table:t.state.obs.tables.bucketTable,item:{[e.data.bucket.name]:Object.assign(e.data.bucket,{localId:e.data.bucket.name})}}),c.Z.create({classes:"notification-positive shadow-15",icon:"check_circle",textColor:"positive",message:"成功创建存储桶："+u.value,position:"bottom",closeBtn:!0,timeout:5e3,multiLine:!1}),i()}catch(o){d.value.$props.loading=!1,d.value.focus(),I().isAxiosError(o)?"BucketAlreadyOwnedByYou"===(null===(e=o.response)||void 0===e?void 0:e.data.code)?c.Z.create({classes:"notification-negative shadow-15",icon:"mdi-alert",textColor:"negative",message:"请输入其它名称",caption:"您已经拥有同名称的存储桶",position:"bottom",closeBtn:!0,timeout:5e3,multiLine:!1}):"BucketAlreadyExists"===(null===(a=o.response)||void 0===a?void 0:a.data.code)&&c.Z.create({classes:"notification-negative shadow-15",icon:"mdi-alert",textColor:"negative",message:"请输入其它名称",caption:u.value+"已经被其他用户占用",position:"bottom",closeBtn:!0,timeout:5e3,multiLine:!1}):c.Z.create({classes:"notification-negative shadow-15",icon:"mdi-alert",textColor:"negative",message:"创建存储桶失败",caption:"请重试",position:"bottom",closeBtn:!0,timeout:5e3,multiLine:!1})}}})),r=n,u=(0,Z.iH)(""),d=(0,Z.iH)();return(e,t)=>{const i=(0,q.up)("q-space"),n=(0,q.up)("q-btn"),s=(0,q.up)("q-card-section"),c=(0,q.up)("q-separator"),m=(0,q.up)("q-card-actions"),p=(0,q.up)("q-card"),b=(0,q.up)("q-dialog"),h=(0,q.Q2)("close-popup");return(0,q.wg)(),(0,q.j4)(b,{ref_key:"dialogRef",ref:a,onHide:(0,Z.SU)(o)},{default:(0,q.w5)((()=>[(0,q.Wm)(p,{class:"q-dialog-plugin dialog-primary"},{default:(0,q.w5)((()=>[(0,q.Wm)(s,{class:"row items-center justify-center q-pb-md"},{default:(0,q.w5)((()=>[(0,q._)("div",H,(0,x.zw)(e.$t("新建存储桶")),1),(0,q.Wm)(i),(0,q.wy)((0,q.Wm)(n,{icon:"close",flat:"",dense:"",size:"sm"},null,512),[[h]])])),_:1}),(0,q.Wm)(c),(0,q.Wm)(s,null,{default:(0,q.w5)((()=>[(0,q._)("div",Q,[D,(0,q._)("div",P,[(0,q.Wm)((0,Z.SU)(C.Z),{ref_key:"inputRef",ref:d,autofocus:"",outlined:"",modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=e=>u.value=e),dense:"",clearable:"","clear-icon":"close",maxlength:"63",counter:"",style:{padding:"5px 0"},onKeydown:(0,W.D2)(l,["enter"])},null,8,["modelValue","onKeydown"])])]),O])),_:1}),(0,q.Wm)(c),(0,q.Wm)(m,{align:"between"},{default:(0,q.w5)((()=>[(0,q.Wm)(n,{class:"q-ma-sm",color:"primary",label:"创建",unelevated:"",onClick:l}),(0,q.Wm)(n,{class:"q-ma-sm",color:"primary",label:"取消",unelevated:"",onClick:(0,Z.SU)(r)},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["onHide"])}}});var L=a(6778),N=a(151),A=a(5589),U=a(2025),$=a(2165),R=a(5869),z=a(9367),F=a(677),K=a(7518),V=a.n(K);const E=B,J=E;V()(B,"components",{QDialog:L.Z,QCard:N.Z,QCardSection:A.Z,QSpace:U.Z,QBtn:$.Z,QSeparator:R.Z,QInput:C.Z,QCardActions:z.Z}),V()(B,"directives",{ClosePopup:F.Z});var M=function(e,t,a,o){function i(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,n){function l(e){try{r(o.next(e))}catch(t){n(t)}}function s(e){try{r(o["throw"](e))}catch(t){n(t)}}function r(e){e.done?a(e.value):i(e.value).then(l,s)}r((o=o.apply(e,t||[])).next())}))};const Y={class:"text-negative"},G={class:"row q-pb-md items-center"},X={class:"col-auto text-grey-7"},ee={class:"col row items-center"},te=(0,q._)("div",{class:"col-2 text-grey-7"}," 存储桶名称 ",-1),ae={class:"col"},oe=(0,q._)("div",{class:"row items-center"},[(0,q._)("div",{class:"col text-grey-7"}," 请仔细阅读以下事项，并在确认后勾选： ")],-1),ie=(0,q.aZ)({props:{bucketNames:{type:Array,required:!0}},emits:[...S.Z.emits],setup(e){const t=e,a=ca(),{dialogRef:o,onDialogHide:i,onDialogOK:n,onDialogCancel:l}=(0,S.Z)(),r=l,u=(0,Z.iH)(!1),d=t.bucketNames.map((e=>{var t;return null===(t=a.state.obs.tables.bucketTable.byLocalId[e])||void 0===t?void 0:t.id})),m=()=>M(this,void 0,void 0,(function*(){try{c.Z.create({classes:"notification-positive shadow-15",icon:"las la-redo-alt",textColor:"positive",message:"正在删除存储桶...",position:"bottom",closeBtn:!0,timeout:5e3,multiLine:!1});const e=yield s.Wh.api.deleteBucketsIdOrName({path:{id_or_name:d[0].toString()},query:{"by-name":!1,ids:d.slice(1)}});204===e.status&&(t.bucketNames.forEach((e=>{a.commit("obs/deleteItem",{table:a.state.obs.tables.bucketTable,id:e})})),c.Z.create({classes:"notification-positive shadow-15",icon:"check_circle",textColor:"positive",message:"成功删除存储桶",position:"bottom",closeBtn:!0,timeout:5e3,multiLine:!1}),n())}catch(e){}}));return(e,a)=>{const n=(0,q.up)("q-space"),l=(0,q.up)("q-btn"),s=(0,q.up)("q-card-section"),c=(0,q.up)("q-separator"),d=(0,q.up)("q-checkbox"),p=(0,q.up)("q-card-actions"),b=(0,q.up)("q-card"),h=(0,q.up)("q-dialog"),f=(0,q.Q2)("close-popup");return(0,q.wg)(),(0,q.j4)(h,{ref_key:"dialogRef",ref:o,onHide:(0,Z.SU)(i)},{default:(0,q.w5)((()=>[(0,q.Wm)(b,{class:"q-dialog-plugin dialog-negative"},{default:(0,q.w5)((()=>[(0,q.Wm)(s,{class:"row items-center justify-center q-pb-md"},{default:(0,q.w5)((()=>[(0,q._)("div",Y,(0,x.zw)(e.$t("删除存储桶")),1),(0,q.Wm)(n),(0,q.wy)((0,q.Wm)(l,{icon:"close",flat:"",dense:"",size:"sm"},null,512),[[f]])])),_:1}),(0,q.Wm)(c),(0,q.Wm)(s,null,{default:(0,q.w5)((()=>[(0,q._)("div",G,[(0,q._)("div",X," 即将删除以下"+(0,x.zw)(t.bucketNames.length)+"个存储桶： ",1)]),((0,q.wg)(!0),(0,q.iD)(q.HY,null,(0,q.Ko)(t.bucketNames,(e=>((0,q.wg)(),(0,q.iD)("div",{key:e,class:"row q-mb-xs q-pa-md items-center bg-grey-2"},[(0,q._)("div",ee,[te,(0,q._)("div",ae,(0,x.zw)(e),1)])])))),128))])),_:1}),(0,q.Wm)(c),(0,q.Wm)(s,null,{default:(0,q.w5)((()=>[oe,(0,q.Wm)(d,{style:{"margin-left":"-10px"},modelValue:u.value,"onUpdate:modelValue":a[0]||(a[0]=e=>u.value=e),color:"primary"},{default:(0,q.w5)((()=>[(0,q._)("div",{class:(0,x.C_)(u.value?"text-primary":"text-black")},(0,x.zw)(e.$t("我了解删除存储桶将会导致其内部文件丢失")),3)])),_:1},8,["modelValue"])])),_:1}),(0,q.Wm)(c),(0,q.Wm)(p,{align:"between"},{default:(0,q.w5)((()=>[(0,q.Wm)(l,{class:"q-ma-sm",color:"negative",label:"删除",unelevated:"",disable:!u.value,onClick:m},null,8,["disable"]),(0,q.Wm)(l,{class:"q-ma-sm",color:"primary",label:"取消",unelevated:"",onClick:(0,Z.SU)(r)},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["onHide"])}}});var ne=a(5735);const le=ie,se=le;V()(ie,"components",{QDialog:L.Z,QCard:N.Z,QCardSection:A.Z,QSpace:U.Z,QBtn:$.Z,QSeparator:R.Z,QCheckbox:ne.Z,QCardActions:z.Z}),V()(ie,"directives",{ClosePopup:F.Z});var re=function(e,t,a,o){function i(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,n){function l(e){try{r(o.next(e))}catch(t){n(t)}}function s(e){try{r(o["throw"](e))}catch(t){n(t)}}function r(e){e.done?a(e.value):i(e.value).then(l,s)}r((o=o.apply(e,t||[])).next())}))};const ce={class:"text-primary"},ue={class:"row q-pb-lg items-center"},de={class:"col-2 text-grey-7"},me={class:"col"},pe=(0,q.aZ)({props:{bucketName:{type:String,required:!0},isRo:{type:Boolean,required:!0}},emits:[...S.Z.emits],setup(e){const t=e,a=ca(),{dialogRef:o,onDialogHide:i,onDialogOK:n,onDialogCancel:l}=(0,S.Z)(),r=l,u=(0,Z.iH)(a.state.obs.tables.bucketTable.byLocalId[t.bucketName][t.isRo?"ftp_ro_password":"ftp_password"]||""),d=(0,Z.iH)(),m=()=>re(this,void 0,void 0,(function*(){if(u.value.length<6||u.value.length>20)c.Z.create({classes:"notification-negative shadow-15",icon:"las la-times-circle",textColor:"negative",message:"密码长度应为6-30个字符",position:"bottom",closeBtn:!0,timeout:5e3,multiLine:!1});else{c.Z.create({classes:"notification-positive shadow-15",icon:"las la-redo-alt",textColor:"positive",message:"正在修改FTP密码...",position:"bottom",closeBtn:!0,timeout:5e3,multiLine:!1});try{d.value.$props.loading=!0;const e=yield s.Wh.api.patchFtpBucketName({path:{bucket_name:t.bucketName},query:t.isRo?{ro_password:u.value}:{password:u.value}});a.commit("obs/storeItemField",{table:a.state.obs.tables.bucketTable,id:t.bucketName,field:t.isRo?"ftp_ro_password":"ftp_password",value:t.isRo?e.data.data.ro_password:e.data.data.password}),c.Z.create({classes:"notification-positive shadow-15",icon:"check_circle",textColor:"positive",message:"成功修改FTP密码",position:"bottom",closeBtn:!0,timeout:5e3,multiLine:!1}),n()}catch(e){d.value.focus()}}}));return(e,a)=>{const n=(0,q.up)("q-space"),l=(0,q.up)("q-btn"),s=(0,q.up)("q-card-section"),c=(0,q.up)("q-separator"),p=(0,q.up)("q-card-actions"),b=(0,q.up)("q-card"),h=(0,q.up)("q-dialog"),f=(0,q.Q2)("close-popup");return(0,q.wg)(),(0,q.j4)(h,{ref_key:"dialogRef",ref:o,onHide:(0,Z.SU)(i)},{default:(0,q.w5)((()=>[(0,q.Wm)(b,{class:"q-dialog-plugin dialog-primary"},{default:(0,q.w5)((()=>[(0,q.Wm)(s,{class:"row items-center justify-center q-pb-md"},{default:(0,q.w5)((()=>[(0,q._)("div",ce,(0,x.zw)("修改"+t.bucketName+"的FTP密码"),1),(0,q.Wm)(n),(0,q.wy)((0,q.Wm)(l,{icon:"close",flat:"",dense:"",size:"sm"},null,512),[[f]])])),_:1}),(0,q.Wm)(c),(0,q.Wm)(s,null,{default:(0,q.w5)((()=>[(0,q._)("div",ue,[(0,q._)("div",de,(0,x.zw)(t.isRo?"只读密码":"读写密码"),1),(0,q._)("div",me,[(0,q.Wm)((0,Z.SU)(C.Z),{ref_key:"inputRef",ref:d,autofocus:"",outlined:"",modelValue:u.value,"onUpdate:modelValue":a[0]||(a[0]=e=>u.value=e),dense:"",clearable:"","clear-icon":"close",maxlength:"20",counter:"",style:{padding:"5px 0"},onKeydown:(0,W.D2)(m,["enter"])},null,8,["modelValue","onKeydown"])])])])),_:1}),(0,q.Wm)(c),(0,q.Wm)(p,{align:"between"},{default:(0,q.w5)((()=>[(0,q.Wm)(l,{class:"q-ma-sm",color:"primary",label:"修改",unelevated:"",onClick:m}),(0,q.Wm)(l,{class:"q-ma-sm",color:"primary",label:"取消",unelevated:"",onClick:(0,Z.SU)(r)},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["onHide"])}}}),be=pe,he=be;V()(pe,"components",{QDialog:L.Z,QCard:N.Z,QCardSection:A.Z,QSpace:U.Z,QBtn:$.Z,QSeparator:R.Z,QInput:C.Z,QCardActions:z.Z}),V()(pe,"directives",{ClosePopup:F.Z});var fe=function(e,t,a,o){function i(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,n){function l(e){try{r(o.next(e))}catch(t){n(t)}}function s(e){try{r(o["throw"](e))}catch(t){n(t)}}function r(e){e.done?a(e.value):i(e.value).then(l,s)}r((o=o.apply(e,t||[])).next())}))};const ge={class:"text-primary"},ve={class:"row q-pb-lg items-center"},ye=(0,q._)("div",{class:"col-2 text-grey-7"}," 备注 ",-1),ke={class:"col"},we=(0,q.aZ)({props:{bucketName:{type:String,required:!0}},emits:[...S.Z.emits],setup(e){var t;const a=e,o=ca(),{dialogRef:i,onDialogHide:n,onDialogOK:l,onDialogCancel:r}=(0,S.Z)(),u=50,d=r,m=(0,Z.iH)(null===(t=o.state.obs.tables.bucketTable.byLocalId[a.bucketName])||void 0===t?void 0:t.remarks),p=(0,Z.iH)(),b=()=>fe(this,void 0,void 0,(function*(){if(m.value.length<1||m.value.length>u)c.Z.create({classes:"notification-negative shadow-15",icon:"las la-times-circle",textColor:"negative",message:"备注长度应在1-"+u+"个字符之间",position:"bottom",closeBtn:!0,timeout:5e3,multiLine:!1});else{c.Z.create({classes:"notification-positive shadow-15",icon:"las la-redo-alt",textColor:"positive",message:"正在修改备注...",position:"bottom",closeBtn:!0,timeout:5e3,multiLine:!1});try{p.value.$props.loading=!0,yield s.Wh.api.patchBucketsIdOrNameRemark({path:{id_or_name:a.bucketName},query:{"by-name":!0,remarks:m.value}}),o.commit("obs/storeItemField",{table:o.state.obs.tables.bucketTable,id:a.bucketName,field:"remarks",value:m.value}),c.Z.create({classes:"notification-positive shadow-15",icon:"check_circle",textColor:"positive",message:"成功修改存储桶备注",position:"bottom",closeBtn:!0,timeout:5e3,multiLine:!1}),l()}catch(e){p.value.focus()}}}));return(e,t)=>{const o=(0,q.up)("q-space"),l=(0,q.up)("q-btn"),s=(0,q.up)("q-card-section"),r=(0,q.up)("q-separator"),c=(0,q.up)("q-card-actions"),h=(0,q.up)("q-card"),f=(0,q.up)("q-dialog"),g=(0,q.Q2)("close-popup");return(0,q.wg)(),(0,q.j4)(f,{ref_key:"dialogRef",ref:i,onHide:(0,Z.SU)(n)},{default:(0,q.w5)((()=>[(0,q.Wm)(h,{class:"q-dialog-plugin dialog-primary"},{default:(0,q.w5)((()=>[(0,q.Wm)(s,{class:"row items-center justify-center q-pb-md"},{default:(0,q.w5)((()=>[(0,q._)("div",ge,(0,x.zw)("修改"+a.bucketName+"的备注"),1),(0,q.Wm)(o),(0,q.wy)((0,q.Wm)(l,{icon:"close",flat:"",dense:"",size:"sm"},null,512),[[g]])])),_:1}),(0,q.Wm)(r),(0,q.Wm)(s,null,{default:(0,q.w5)((()=>[(0,q._)("div",ve,[ye,(0,q._)("div",ke,[(0,q.Wm)((0,Z.SU)(C.Z),{ref_key:"inputRef",ref:p,autofocus:"",outlined:"",modelValue:m.value,"onUpdate:modelValue":t[0]||(t[0]=e=>m.value=e),dense:"",clearable:"","clear-icon":"close",maxlength:u,counter:"",style:{padding:"5px 0"},onKeydown:(0,W.D2)(b,["enter"])},null,8,["modelValue","onKeydown"])])])])),_:1}),(0,q.Wm)(r),(0,q.Wm)(c,{align:"between"},{default:(0,q.w5)((()=>[(0,q.Wm)(l,{class:"q-ma-sm",color:"primary",label:"修改",unelevated:"",onClick:b}),(0,q.Wm)(l,{class:"q-ma-sm",color:"primary",label:"取消",unelevated:"",onClick:(0,Z.SU)(d)},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["onHide"])}}}),_e=we,qe=_e;V()(we,"components",{QDialog:L.Z,QCard:N.Z,QCardSection:A.Z,QSpace:U.Z,QBtn:$.Z,QSeparator:R.Z,QInput:C.Z,QCardActions:z.Z}),V()(we,"directives",{ClosePopup:F.Z});var Ze=function(e,t,a,o){function i(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,n){function l(e){try{r(o.next(e))}catch(t){n(t)}}function s(e){try{r(o["throw"](e))}catch(t){n(t)}}function r(e){e.done?a(e.value):i(e.value).then(l,s)}r((o=o.apply(e,t||[])).next())}))};const xe={class:"text-primary"},We={class:"row items-center"},Ce=(0,q._)("div",{class:"col-2 text-grey-7"}," token数量 ",-1),Se={class:"col"},je={class:"col-2 text-grey-7"},Ie={class:"col"},Te={class:"q-ma-sm row items-center"},He={key:0,class:"text-negative"},Qe=(0,q.aZ)({props:{bucketName:{type:String,required:!0}},emits:[...S.Z.emits],setup(e){const t=e,a=ca();(0,q.wF)((()=>Ze(this,void 0,void 0,(function*(){a.state.obs.tables.bucketTokenTable.allLocalIds.includes(t.bucketName)||(yield a.dispatch("obs/addBucketTokenTable",{bucket:t.bucketName}))}))));const{dialogRef:o,onDialogHide:i,onDialogOK:n,onDialogCancel:l}=(0,S.Z)(),r=l,u=e=>Ze(this,void 0,void 0,(function*(){try{const o=yield s.Wh.api.postBucketsIdOrNameTokenCreate({path:{id_or_name:t.bucketName},query:{"by-name":!0,permission:e}});a.commit("obs/storeItemField",{table:a.state.obs.tables.bucketTokenTable,id:t.bucketName,field:"tokens",value:[...a.state.obs.tables.bucketTokenTable.byLocalId[t.bucketName].tokens,o.data]}),c.Z.create({classes:"notification-positive shadow-15",icon:"check_circle",textColor:"positive",message:"成功创建存储桶token",position:"bottom",closeBtn:!0,timeout:5e3,multiLine:!1}),n()}catch(o){}}));return(e,n)=>{const l=(0,q.up)("q-space"),s=(0,q.up)("q-btn"),c=(0,q.up)("q-card-section"),d=(0,q.up)("q-separator"),m=(0,q.up)("q-card-actions"),p=(0,q.up)("q-card"),b=(0,q.up)("q-dialog"),h=(0,q.Q2)("close-popup");return(0,q.wg)(),(0,q.j4)(b,{ref_key:"dialogRef",ref:o,onHide:(0,Z.SU)(i)},{default:(0,q.w5)((()=>[(0,q.Wm)(p,{class:"q-dialog-plugin dialog-primary"},{default:(0,q.w5)((()=>[(0,q.Wm)(c,{class:"row items-center justify-center q-pb-md"},{default:(0,q.w5)((()=>[(0,q._)("div",xe,(0,x.zw)("为"+t.bucketName+"创建token"),1),(0,q.Wm)(l),(0,q.wy)((0,q.Wm)(s,{icon:"close",flat:"",dense:"",size:"sm"},null,512),[[h]])])),_:1}),(0,q.Wm)(d),(0,q.Wm)(c,null,{default:(0,q.w5)((()=>{var e,o;return[(0,q._)("div",We,[Ce,(0,q._)("div",Se,(0,x.zw)(null===(e=(0,Z.SU)(a).state.obs.tables.bucketTokenTable.byLocalId[t.bucketName])||void 0===e?void 0:e.tokens.length),1)]),((0,q.wg)(!0),(0,q.iD)(q.HY,null,(0,q.Ko)(null===(o=(0,Z.SU)(a).state.obs.tables.bucketTokenTable.byLocalId[t.bucketName])||void 0===o?void 0:o.tokens,((e,t)=>((0,q.wg)(),(0,q.iD)("div",{class:"row q-pt-lg items-center",key:t},[(0,q._)("div",je,(0,x.zw)("token"+(t+1)),1),(0,q._)("div",Ie,(0,x.zw)(e.key),1)])))),128))]})),_:1}),(0,q.Wm)(d),(0,q.Wm)(m,{align:"between"},{default:(0,q.w5)((()=>{var e,o,i;return[(0,q._)("div",Te,[(0,q.Wm)(s,{color:"primary",label:"创建读写token",unelevated:"","no-caps":"",disable:2===(null===(e=(0,Z.SU)(a).state.obs.tables.bucketTokenTable.byLocalId[t.bucketName])||void 0===e?void 0:e.tokens.length),onClick:n[0]||(n[0]=e=>u("readwrite"))},null,8,["disable"]),(0,q.Wm)(s,{class:"q-mx-md",color:"primary",label:"创建只读token",unelevated:"","no-caps":"",disable:2===(null===(o=(0,Z.SU)(a).state.obs.tables.bucketTokenTable.byLocalId[t.bucketName])||void 0===o?void 0:o.tokens.length),onClick:n[1]||(n[1]=e=>u("readonly"))},null,8,["disable"]),2===(null===(i=(0,Z.SU)(a).state.obs.tables.bucketTokenTable.byLocalId[t.bucketName])||void 0===i?void 0:i.tokens.length)?((0,q.wg)(),(0,q.iD)("div",He," 已达最大token数量 ")):(0,q.kq)("",!0)]),(0,q.Wm)(s,{class:"q-ma-sm",color:"primary",label:"取消",unelevated:"",onClick:(0,Z.SU)(r)},null,8,["onClick"])]})),_:1})])),_:1})])),_:1},8,["onHide"])}}}),De=Qe,Pe=De;V()(Qe,"components",{QDialog:L.Z,QCard:N.Z,QCardSection:A.Z,QSpace:U.Z,QBtn:$.Z,QSeparator:R.Z,QCardActions:z.Z}),V()(Qe,"directives",{ClosePopup:F.Z});var Oe=function(e,t,a,o){function i(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,n){function l(e){try{r(o.next(e))}catch(t){n(t)}}function s(e){try{r(o["throw"](e))}catch(t){n(t)}}function r(e){e.done?a(e.value):i(e.value).then(l,s)}r((o=o.apply(e,t||[])).next())}))};const Be=(0,q._)("div",{class:"text-primary"},(0,x.zw)("删除token"),-1),Le={class:"row items-center"},Ne=(0,q._)("div",{class:"col-2 text-grey-7"}," 所属存储桶： ",-1),Ae={class:"col"},Ue={class:"row q-pt-lg items-center"},$e=(0,q._)("div",{class:"col-2 text-grey-7"}," token: ",-1),Re={class:"col"},ze=(0,q._)("div",{class:"row items-center"},[(0,q._)("div",{class:"col text-grey-7"}," 请仔细阅读以下事项，并在确认后勾选： ")],-1),Fe=(0,q.aZ)({props:{bucketName:{type:String,required:!0},token:{type:String,required:!0}},emits:[...S.Z.emits],setup(e){const t=e,a=ca();(0,q.wF)((()=>Oe(this,void 0,void 0,(function*(){a.state.obs.tables.bucketTokenTable.allLocalIds.includes(t.bucketName)||(yield a.dispatch("obs/addBucketTokenTable",{bucket:t.bucketName}))}))));const{dialogRef:o,onDialogHide:i,onDialogOK:n,onDialogCancel:l}=(0,S.Z)(),r=l,u=(0,Z.iH)(!1),d=()=>Oe(this,void 0,void 0,(function*(){try{const e=yield s.Wh.api.deleteBucketToken({path:{token:t.token}});204===e.status&&(a.commit("obs/storeItemField",{table:a.state.obs.tables.bucketTokenTable,id:t.bucketName,field:"tokens",value:a.state.obs.tables.bucketTokenTable.byLocalId[t.bucketName].tokens.filter((e=>e.key!==t.token))}),c.Z.create({classes:"notification-positive shadow-15",icon:"check_circle",textColor:"positive",message:"成功删除token",position:"bottom",closeBtn:!0,timeout:5e3,multiLine:!1}),n())}catch(e){}}));return(e,a)=>{const n=(0,q.up)("q-space"),l=(0,q.up)("q-btn"),s=(0,q.up)("q-card-section"),c=(0,q.up)("q-separator"),m=(0,q.up)("q-checkbox"),p=(0,q.up)("q-card-actions"),b=(0,q.up)("q-card"),h=(0,q.up)("q-dialog"),f=(0,q.Q2)("close-popup");return(0,q.wg)(),(0,q.j4)(h,{ref_key:"dialogRef",ref:o,onHide:(0,Z.SU)(i)},{default:(0,q.w5)((()=>[(0,q.Wm)(b,{class:"q-dialog-plugin dialog-primary"},{default:(0,q.w5)((()=>[(0,q.Wm)(s,{class:"row items-center justify-center q-pb-md"},{default:(0,q.w5)((()=>[Be,(0,q.Wm)(n),(0,q.wy)((0,q.Wm)(l,{icon:"close",flat:"",dense:"",size:"sm"},null,512),[[f]])])),_:1}),(0,q.Wm)(c),(0,q.Wm)(s,null,{default:(0,q.w5)((()=>[(0,q._)("div",Le,[Ne,(0,q._)("div",Ae,(0,x.zw)(t.bucketName),1)]),(0,q._)("div",Ue,[$e,(0,q._)("div",Re,(0,x.zw)(t.token),1)])])),_:1}),(0,q.Wm)(c),(0,q.Wm)(s,null,{default:(0,q.w5)((()=>[ze,(0,q.Wm)(m,{style:{"margin-left":"-10px"},modelValue:u.value,"onUpdate:modelValue":a[0]||(a[0]=e=>u.value=e),color:"primary"},{default:(0,q.w5)((()=>[(0,q._)("div",{class:(0,x.C_)(u.value?"text-primary":"text-black")},(0,x.zw)(e.$t("我了解删除的token将无法恢复")),3)])),_:1},8,["modelValue"])])),_:1}),(0,q.Wm)(c),(0,q.Wm)(p,{align:"between"},{default:(0,q.w5)((()=>[(0,q.Wm)(l,{class:"q-ma-sm",color:"negative",label:"删除",unelevated:"",disable:!u.value,onClick:d},null,8,["disable"]),(0,q.Wm)(l,{class:"q-ma-sm",color:"primary",label:"取消",unelevated:"",onClick:(0,Z.SU)(r)},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["onHide"])}}}),Ke=Fe,Ve=Ke;V()(Fe,"components",{QDialog:L.Z,QCard:N.Z,QCardSection:A.Z,QSpace:U.Z,QBtn:$.Z,QSeparator:R.Z,QCheckbox:ne.Z,QCardActions:z.Z}),V()(Fe,"directives",{ClosePopup:F.Z});var Ee=function(e,t,a,o){function i(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,n){function l(e){try{r(o.next(e))}catch(t){n(t)}}function s(e){try{r(o["throw"](e))}catch(t){n(t)}}function r(e){e.done?a(e.value):i(e.value).then(l,s)}r((o=o.apply(e,t||[])).next())}))};const Je={class:"text-primary"},Me={class:"row q-pb-lg items-center"},Ye=(0,q._)("div",{class:"col-2 text-grey-7"}," 文件夹名称 ",-1),Ge={class:"col"},Xe=(0,q._)("div",{class:"row q-pb-lg items-start"},[(0,q._)("div",{class:"col-2 text-grey-7"}," 名称规则 "),(0,q._)("div",{class:"col"}," 长度介于3-63个字符之间 ")],-1),et=(0,q.aZ)({props:{bucket_name:{type:String,required:!0}},emits:[...S.Z.emits],setup(e){const t=e,a=ca(),{dialogRef:o,onDialogHide:i,onDialogOK:n,onDialogCancel:l}=(0,S.Z)(),r=()=>Ee(this,void 0,void 0,(function*(){if(null===d.value||d.value.length<3||d.value.length>64)c.Z.create({classes:"notification-negative shadow-15",icon:"las la-times-circle",textColor:"negative",message:"文件夹名称长度应为3-63个字符",position:"bottom",closeBtn:!0,timeout:5e3,multiLine:!1});else{m.value.$props.loading=!0;try{const e=yield s.Wh.api.postDirPath({path:{dirpath:d.value,bucket_name:t.bucket_name}});a.commit("obs/storeSingleFileItem",{table:a.state.obs.tables.pathTable,item:{files:e.data.dir,bucket_name:t.bucket_name}}),c.Z.create({classes:"notification-positive shadow-15",icon:"check_circle",textColor:"positive",message:"创建文件夹成功",position:"bottom",closeBtn:!0,timeout:5e3,multiLine:!1}),n()}catch(e){m.value.$props.loading=!1,m.value.focus()}}})),u=l,d=(0,Z.iH)(""),m=(0,Z.iH)();return(e,t)=>{const a=(0,q.up)("q-space"),n=(0,q.up)("q-btn"),l=(0,q.up)("q-card-section"),s=(0,q.up)("q-separator"),c=(0,q.up)("q-card-actions"),p=(0,q.up)("q-card"),b=(0,q.up)("q-dialog"),h=(0,q.Q2)("close-popup");return(0,q.wg)(),(0,q.j4)(b,{ref_key:"dialogRef",ref:o,onHide:(0,Z.SU)(i)},{default:(0,q.w5)((()=>[(0,q.Wm)(p,{class:"q-dialog-plugin dialog-primary"},{default:(0,q.w5)((()=>[(0,q.Wm)(l,{class:"row items-center justify-center q-pb-md"},{default:(0,q.w5)((()=>[(0,q._)("div",Je,(0,x.zw)(e.$t("新建文件夹")),1),(0,q.Wm)(a),(0,q.wy)((0,q.Wm)(n,{icon:"close",flat:"",dense:"",size:"sm"},null,512),[[h]])])),_:1}),(0,q.Wm)(s),(0,q.Wm)(l,null,{default:(0,q.w5)((()=>[(0,q._)("div",Me,[Ye,(0,q._)("div",Ge,[(0,q.Wm)((0,Z.SU)(C.Z),{ref_key:"inputRef",ref:m,autofocus:"",outlined:"",modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=e=>d.value=e),dense:"",clearable:"","clear-icon":"close",maxlength:"63",counter:"",style:{padding:"5px 0"},onKeydown:(0,W.D2)(r,["enter"])},null,8,["modelValue","onKeydown"])])]),Xe])),_:1}),(0,q.Wm)(s),(0,q.Wm)(c,{align:"between"},{default:(0,q.w5)((()=>[(0,q.Wm)(n,{class:"q-ma-sm",color:"primary",label:"创建",unelevated:"",onClick:r}),(0,q.Wm)(n,{class:"q-ma-sm",color:"primary",label:"取消",unelevated:"",onClick:(0,Z.SU)(u)},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["onHide"])}}}),tt=et,at=tt;V()(et,"components",{QDialog:L.Z,QCard:N.Z,QCardSection:A.Z,QSpace:U.Z,QBtn:$.Z,QSeparator:R.Z,QInput:C.Z,QCardActions:z.Z}),V()(et,"directives",{ClosePopup:F.Z});var ot=function(e,t,a,o){function i(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,n){function l(e){try{r(o.next(e))}catch(t){n(t)}}function s(e){try{r(o["throw"](e))}catch(t){n(t)}}function r(e){e.done?a(e.value):i(e.value).then(l,s)}r((o=o.apply(e,t||[])).next())}))};const it=(0,q._)("div",{class:"text-center"},[(0,q._)("h5",null,"确认要删除吗？")],-1),nt=(0,q._)("div",{class:"text-center"},[(0,q._)("h6",null,"此操作是不可逆的！")],-1),lt=(0,q.aZ)({props:{bucket_name:{type:String,required:!0},dirpath:{type:Object,required:!0}},emits:[...S.Z.emits],setup(e){const t=e,a=ca(),{dialogRef:o,onDialogHide:i,onDialogOK:n,onDialogCancel:l}=(0,S.Z)(),r=()=>ot(this,void 0,void 0,(function*(){let e=null,o=null;const i=[],l=[];if(t.dirpath.dirArrs&&t.dirpath.dirArrs.length>0)for(const a of t.dirpath.dirArrs)e=yield s.Wh.api.deleteDirPath({path:{dirpath:a,bucket_name:t.bucket_name}}),204===e.status&&i.push(a),e=null;if(t.dirpath.fileArrs&&t.dirpath.fileArrs.length>0)for(const a of t.dirpath.fileArrs)o=yield s.Wh.api.deleteObjPath({path:{objpath:a,bucket_name:t.bucket_name}}),204===o.status&&l.push(a),o=null;a.commit("obs/deleteFile",{table:a.state.obs.tables.pathTable,item:{bucket_name:t.bucket_name,dirpath:{dirArrs:i,fileArrs:l}}}),c.Z.create({classes:"notification-positive shadow-15",icon:"check_circle",textColor:"positive",message:"删除成功",position:"bottom",closeBtn:!0,timeout:5e3,multiLine:!1}),n()})),u=l;return(e,t)=>{const a=(0,q.up)("q-btn"),n=(0,q.up)("q-card-actions"),l=(0,q.up)("q-card"),s=(0,q.up)("q-dialog");return(0,q.wg)(),(0,q.j4)(s,{ref_key:"dialogRef",ref:o,onHide:(0,Z.SU)(i)},{default:(0,q.w5)((()=>[(0,q.Wm)(l,{class:"q-dialog-plugin dialog-primary"},{default:(0,q.w5)((()=>[it,nt,(0,q.Wm)(n,{align:"center"},{default:(0,q.w5)((()=>[(0,q.Wm)(a,{class:"q-ma-sm",color:"primary",label:"确认",unelevated:"",onClick:r}),(0,q.Wm)(a,{class:"q-ma-sm",color:"primary",label:"取消",unelevated:"",onClick:(0,Z.SU)(u)},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["onHide"])}}}),st=lt,rt=st;V()(lt,"components",{QDialog:L.Z,QCard:N.Z,QCardActions:z.Z,QBtn:$.Z});var ct=a(9582),ut=function(e,t,a,o){function i(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,n){function l(e){try{r(o.next(e))}catch(t){n(t)}}function s(e){try{r(o["throw"](e))}catch(t){n(t)}}function r(e){e.done?a(e.value):i(e.value).then(l,s)}r((o=o.apply(e,t||[])).next())}))};const dt={class:"row justify-center q-mt-xl"},mt=(0,q.aZ)({props:{bucket_name:{type:String,required:!0}},emits:[...S.Z.emits],setup(e){const t=e,a=(0,ct.yj)(),o=ca(),i=a.query.bucket,n=a.query.path,{dialogRef:l,onDialogHide:r,onDialogOK:u,onDialogCancel:d}=(0,S.Z)(),m=d;let p=null;const b=e=>ut(this,void 0,void 0,(function*(){const a=new FormData;a.append("file",e[0]),yield s.Wh.api.putObjPath({path:{objpath:e[0].name,bucket_name:t.bucket_name},body:{file:a}}),o.dispatch("obs/addPathTable",{bucket:i,path:n}),c.Z.create({classes:"notification-positive shadow-15",icon:"check_circle",textColor:"positive",message:"上传成功",position:"bottom",closeBtn:!0,timeout:5e3,multiLine:!1}),u()})),h=e=>{p=e},f=()=>{p=null},g=()=>{null!==p?b(p):c.Z.create({classes:"notification-negative shadow-15",icon:"las la-times-circle",textColor:"negative",message:"请选择文件",position:"bottom",closeBtn:!0,timeout:5e3,multiLine:!1})};return(e,t)=>{const a=(0,q.up)("q-item-label"),o=(0,q.up)("q-item-section"),i=(0,q.up)("q-btn"),n=(0,q.up)("q-item"),s=(0,q.up)("q-list"),c=(0,q.up)("q-uploader"),u=(0,q.up)("q-dialog");return(0,q.wg)(),(0,q.j4)(u,{ref_key:"dialogRef",ref:l,onHide:(0,Z.SU)(r)},{default:(0,q.w5)((()=>[(0,q.Wm)(c,{factory:b,onAdded:h,onRemoved:f,label:"上传文件",headers:[{"Content-Type":"multipart/form-data"}],style:{width:"450px"}},{list:(0,q.w5)((e=>[(0,q.Wm)(s,{separator:""},{default:(0,q.w5)((()=>[((0,q.wg)(!0),(0,q.iD)(q.HY,null,(0,q.Ko)(e.files,(t=>((0,q.wg)(),(0,q.j4)(n,{key:t.__key},{default:(0,q.w5)((()=>[(0,q.Wm)(o,null,{default:(0,q.w5)((()=>[(0,q.Wm)(a,{class:"full-width ellipsis"},{default:(0,q.w5)((()=>[(0,q.Uk)((0,x.zw)(t.name),1)])),_:2},1024),(0,q.Wm)(a,{caption:""},{default:(0,q.w5)((()=>[(0,q.Uk)((0,x.zw)(t.__sizeLabel)+" / "+(0,x.zw)(t.__progressLabel),1)])),_:2},1024)])),_:2},1024),(0,q.Wm)(o,{top:"",side:""},{default:(0,q.w5)((()=>[(0,q.Wm)(i,{class:"gt-xs",size:"12px",flat:"",dense:"",round:"",icon:"delete",onClick:a=>e.removeFile(t)},null,8,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024),(0,q._)("div",dt,[(0,q.Wm)(i,{class:"q-ma-sm",color:"primary",label:"上传",unelevated:"",onClick:g}),(0,q.Wm)(i,{class:"q-ma-sm",color:"primary",label:"取消",unelevated:"",onClick:(0,Z.SU)(m)},null,8,["onClick"])])])),_:1})])),_:1},8,["onHide"])}}});var pt=a(3768),bt=a(7011),ht=a(3414),ft=a(2035),gt=a(2350);const vt=mt,yt=vt;V()(mt,"components",{QDialog:L.Z,QUploader:pt.Z,QList:bt.Z,QItem:ht.Z,QItemSection:ft.Z,QItemLabel:gt.Z,QBtn:$.Z});var kt=function(e,t,a,o){function i(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,n){function l(e){try{r(o.next(e))}catch(t){n(t)}}function s(e){try{r(o["throw"](e))}catch(t){n(t)}}function r(e){e.done?a(e.value):i(e.value).then(l,s)}r((o=o.apply(e,t||[])).next())}))};const wt={class:"text-primary"},_t={class:"row q-pb-lg items-center"},qt=(0,q._)("div",{class:"col-2 text-grey-7"}," 文件名称 ",-1),Zt={class:"col"},xt=(0,q.aZ)({props:{bucket_name:{type:String,required:!0},objpath:{type:String,required:!0}},emits:[...S.Z.emits],setup(e){const t=e,a=ca(),{dialogRef:o,onDialogHide:i,onDialogOK:n,onDialogCancel:l}=(0,S.Z)(),r=()=>kt(this,void 0,void 0,(function*(){if(""===d.value||null===d.value)c.Z.create({classes:"notification-negative shadow-15",icon:"las la-times-circle",textColor:"negative",message:"文件名称不能为空",position:"bottom",closeBtn:!0,timeout:5e3,multiLine:!1});else if(d.value===t.objpath)c.Z.create({classes:"notification-negative shadow-15",icon:"las la-times-circle",textColor:"negative",message:"文件名称未改变",position:"bottom",closeBtn:!0,timeout:5e3,multiLine:!1});else{m.value.$props.loading=!0;try{const e=yield s.Wh.api.postObjPath({path:{objpath:t.objpath,bucket_name:t.bucket_name},query:{rename:d.value}});a.commit("obs/changeObjName",{table:a.state.obs.tables.pathTable,item:{bucket_name:t.bucket_name,dirName:t.objpath,newName:e.data.obj.name}}),c.Z.create({classes:"notification-positive shadow-15",icon:"check_circle",textColor:"positive",message:"重命名成功",position:"bottom",closeBtn:!0,timeout:5e3,multiLine:!1}),n()}catch(e){m.value.$props.loading=!1,m.value.focus()}}})),u=l,d=(0,Z.iH)(t.objpath),m=(0,Z.iH)();return(e,t)=>{const a=(0,q.up)("q-space"),n=(0,q.up)("q-btn"),l=(0,q.up)("q-card-section"),s=(0,q.up)("q-separator"),c=(0,q.up)("q-card-actions"),p=(0,q.up)("q-card"),b=(0,q.up)("q-dialog"),h=(0,q.Q2)("close-popup");return(0,q.wg)(),(0,q.j4)(b,{ref_key:"dialogRef",ref:o,onHide:(0,Z.SU)(i)},{default:(0,q.w5)((()=>[(0,q.Wm)(p,{class:"q-dialog-plugin dialog-primary"},{default:(0,q.w5)((()=>[(0,q.Wm)(l,{class:"row items-center justify-center q-pb-md"},{default:(0,q.w5)((()=>[(0,q._)("div",wt,(0,x.zw)(e.$t("文件重命名")),1),(0,q.Wm)(a),(0,q.wy)((0,q.Wm)(n,{icon:"close",flat:"",dense:"",size:"sm"},null,512),[[h]])])),_:1}),(0,q.Wm)(s),(0,q.Wm)(l,null,{default:(0,q.w5)((()=>[(0,q._)("div",_t,[qt,(0,q._)("div",Zt,[(0,q.Wm)((0,Z.SU)(C.Z),{ref_key:"inputRef",ref:m,autofocus:"",outlined:"",modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=e=>d.value=e),dense:"",clearable:"","clear-icon":"close",style:{padding:"5px 0"},onKeydown:(0,W.D2)(r,["enter"])},null,8,["modelValue","onKeydown"])])])])),_:1}),(0,q.Wm)(s),(0,q.Wm)(c,{align:"between"},{default:(0,q.w5)((()=>[(0,q.Wm)(n,{class:"q-ma-sm",color:"primary",label:"确认",unelevated:"",onClick:r}),(0,q.Wm)(n,{class:"q-ma-sm",color:"primary",label:"取消",unelevated:"",onClick:(0,Z.SU)(u)},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["onHide"])}}}),Wt=xt,Ct=Wt;V()(xt,"components",{QDialog:L.Z,QCard:N.Z,QCardSection:A.Z,QSpace:U.Z,QBtn:$.Z,QSeparator:R.Z,QInput:C.Z,QCardActions:z.Z}),V()(xt,"directives",{ClosePopup:F.Z});var St=function(e,t,a,o){function i(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,n){function l(e){try{r(o.next(e))}catch(t){n(t)}}function s(e){try{r(o["throw"](e))}catch(t){n(t)}}function r(e){e.done?a(e.value):i(e.value).then(l,s)}r((o=o.apply(e,t||[])).next())}))};const jt={class:"text-primary"},It={class:"row justify-center"},Tt={class:"row justify-center q-mt-md"},Ht={class:"row justify-center q-mt-lg"},Qt=(0,q._)("div",{class:"text-center q-pa-md"}," 提示：创建新的带密码的分享，旧的分享密码会失效 ",-1),Dt=(0,q.aZ)({props:{bucket_name:{type:String,required:!0},pathObj:{type:Object,required:!0}},emits:[...S.Z.emits],setup(e){const t=e,a=ca(),o=(0,ct.yj)(),{dialogRef:i,onDialogHide:n,onDialogOK:l,onDialogCancel:r}=(0,S.Z)(),u=o.query.bucket,d=o.query.path,m=r,p=(0,Z.iH)(null),b=(0,Z.iH)(!1),h=[{label:"私有",value:-1,share:0},{label:"1天",value:1,share:1},{label:"7天",value:7,share:1},{label:"30天",value:30,share:1},{label:"永久公开",value:0,share:1}],f=(0,Z.iH)({share:"",days:""}),g=e=>{null!==e&&(f.value.share=e.share,f.value.days=e.value)},v=e=>{b.value=e},y=()=>St(this,void 0,void 0,(function*(){if(null!==p.value){let e={},o={};if(t.pathObj.dirArrs&&t.pathObj.dirArrs.length>0)if(!1===b.value)for(const a of t.pathObj.dirArrs){const o=yield s.Wh.api.patchDirPath({path:{bucket_name:t.bucket_name,dirpath:a},query:{share:f.value.share,days:f.value.days}});e=o.data}else for(const a of t.pathObj.dirArrs){const o=yield s.Wh.api.patchDirPath({path:{bucket_name:t.bucket_name,dirpath:a},query:{share:f.value.share,days:f.value.days,password:""}});e=o.data}if(t.pathObj.fileArrs&&t.pathObj.fileArrs.length>0)if(!1===b.value)for(const a of t.pathObj.fileArrs){const e=yield s.Wh.api.patchObjPath({path:{bucket_name:t.bucket_name,objpath:a},query:{share:f.value.share,days:f.value.days}});o=e.data}else for(const a of t.pathObj.fileArrs){const e=yield s.Wh.api.patchObjPath({path:{bucket_name:t.bucket_name,objpath:a},query:{share:f.value.share,days:f.value.days,password:""}});o=e.data}0!==f.value.share&&((t.pathObj.dirArrs&&1===t.pathObj.dirArrs.length&&t.pathObj.fileArrs&&0===t.pathObj.fileArrs.length||!t.pathObj.fileArrs&&1===t.pathObj.dirArrs.length)&&(yield a.dispatch("obs/triggerShareLinksDialog",{url:e.share,password:e.share_code})),(t.pathObj.dirArrs&&0===t.pathObj.dirArrs.length&&t.pathObj.fileArrs&&1===t.pathObj.fileArrs.length||!t.pathObj.dirArrs&&1===t.pathObj.fileArrs.length)&&(yield a.dispatch("obs/triggerShareLinksDialog",{url:o.share_uri}))),yield a.dispatch("obs/addPathTable",{bucket:u,path:d}),c.Z.create({classes:"notification-positive shadow-15",icon:"check_circle",textColor:"positive",message:"分享成功",position:"bottom",closeBtn:!0,timeout:5e3,multiLine:!1}),l()}else c.Z.create({classes:"notification-negative shadow-15",icon:"check_circle",textColor:"negative",message:"请选择分享权限",position:"bottom",closeBtn:!0,timeout:5e3,multiLine:!1})}));return(e,t)=>{const a=(0,q.up)("q-space"),o=(0,q.up)("q-btn"),l=(0,q.up)("q-card-section"),s=(0,q.up)("q-separator"),r=(0,q.up)("q-select"),c=(0,q.up)("q-checkbox"),u=(0,q.up)("q-card"),d=(0,q.up)("q-dialog"),f=(0,q.Q2)("close-popup");return(0,q.wg)(),(0,q.j4)(d,{ref_key:"dialogRef",ref:i,onHide:(0,Z.SU)(n)},{default:(0,q.w5)((()=>[(0,q.Wm)(u,{class:"q-dialog-plugin dialog-primary"},{default:(0,q.w5)((()=>[(0,q.Wm)(l,{class:"row items-center justify-center q-pb-md"},{default:(0,q.w5)((()=>[(0,q._)("div",jt,(0,x.zw)(e.$t("分享")),1),(0,q.Wm)(a),(0,q.wy)((0,q.Wm)(o,{icon:"close",flat:"",dense:"",size:"sm"},null,512),[[f]])])),_:1}),(0,q.Wm)(s),(0,q.Wm)(l,null,{default:(0,q.w5)((()=>[(0,q._)("div",It,[(0,q.Wm)(r,{class:"col-6",clearable:"",outlined:"",modelValue:p.value,"onUpdate:modelValue":[t[0]||(t[0]=e=>p.value=e),g],options:h,label:"请选择"},null,8,["modelValue"])]),(0,q._)("div",Tt,[(0,q.Wm)(c,{modelValue:b.value,"onUpdate:modelValue":[t[1]||(t[1]=e=>b.value=e),v],label:"有分享密码保护"},null,8,["modelValue"])]),(0,q._)("div",Ht,[(0,q.Wm)(o,{class:"q-ma-sm",color:"primary",label:"分享",unelevated:"",onClick:y}),(0,q.Wm)(o,{class:"q-ma-sm",color:"primary",label:"取消",unelevated:"",onClick:(0,Z.SU)(m)},null,8,["onClick"])])])),_:1}),(0,q.Wm)(s),Qt])),_:1})])),_:1},8,["onHide"])}}});var Pt=a(8516);const Ot=Dt,Bt=Ot;V()(Dt,"components",{QDialog:L.Z,QCard:N.Z,QCardSection:A.Z,QSpace:U.Z,QBtn:$.Z,QSeparator:R.Z,QSelect:Pt.Z,QCheckbox:ne.Z}),V()(Dt,"directives",{ClosePopup:F.Z});var Lt=function(e,t,a,o){function i(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,n){function l(e){try{r(o.next(e))}catch(t){n(t)}}function s(e){try{r(o["throw"](e))}catch(t){n(t)}}function r(e){e.done?a(e.value):i(e.value).then(l,s)}r((o=o.apply(e,t||[])).next())}))};const Nt=(0,q._)("div",{class:"text-h6 text-left"},"当前对象已经是共享状态，点击“查询”查看当前共享连接，或点击“公开分享”重新设置共享。",-1),At={class:"row justify-center q-mt-lg"},Ut=(0,q._)("div",{class:"text-center q-pa-md"}," 提示：创建新的带密码的分享，旧的分享密码会失效 ",-1),$t=(0,q.aZ)({props:{bucket_name:{type:String,required:!0},pathObj:{type:Object,required:!0}},emits:[...S.Z.emits],setup(e){const t=e,a=ca(),{dialogRef:o,onDialogHide:i,onDialogCancel:n}=(0,S.Z)(),l=n,r=()=>Lt(this,void 0,void 0,(function*(){t.pathObj.dirArrs&&t.pathObj.dirArrs.length>0&&(yield a.dispatch("obs/triggerPublicShareDialog",{localId:t.bucket_name,dirNames:{dirArrs:t.pathObj.dirArrs}})),t.pathObj.fileArrs&&t.pathObj.fileArrs.length>0&&(yield a.dispatch("obs/triggerPublicShareDialog",{localId:t.bucket_name,dirNames:{fileArrs:t.pathObj.fileArrs}})),l()})),c=()=>Lt(this,void 0,void 0,(function*(){let e="";e=t.pathObj.dirArrs?t.pathObj.dirArrs[0]:t.pathObj.fileArrs[0];const o=yield s.Wh.api.getPath({path:{bucket_name:t.bucket_name,path:e}});a.dispatch("obs/triggerShareLinksDialog",{url:o.data.share_uri,password:o.data.share_code}),l()}));return(e,t)=>{const a=(0,q.up)("q-separator"),n=(0,q.up)("q-btn"),s=(0,q.up)("q-card-section"),u=(0,q.up)("q-card"),d=(0,q.up)("q-dialog");return(0,q.wg)(),(0,q.j4)(d,{ref_key:"dialogRef",ref:o,onHide:(0,Z.SU)(i)},{default:(0,q.w5)((()=>[(0,q.Wm)(u,{class:"q-dialog-plugin dialog-primary"},{default:(0,q.w5)((()=>[(0,q.Wm)(a),(0,q.Wm)(s,null,{default:(0,q.w5)((()=>[Nt,(0,q._)("div",At,[(0,q.Wm)(n,{class:"q-ma-sm",color:"primary",label:"公开分享",unelevated:"",onClick:r}),(0,q.Wm)(n,{class:"q-ma-sm",color:"primary",label:"查询",unelevated:"",onClick:c}),(0,q.Wm)(n,{class:"q-ma-sm",color:"primary",label:"取消",unelevated:"",onClick:(0,Z.SU)(l)},null,8,["onClick"])])])),_:1}),(0,q.Wm)(a),Ut])),_:1})])),_:1},8,["onHide"])}}}),Rt=$t,zt=Rt;V()($t,"components",{QDialog:L.Z,QCard:N.Z,QSeparator:R.Z,QCardSection:A.Z,QBtn:$.Z});const Ft=(0,q._)("div",{class:"text-h5 text-center"},"分享链接",-1),Kt={class:"text-subtitle1 text-center q-mt-lg"},Vt={key:0,class:"text-subtitle1 text-center q-mt-lg"},Et={class:"row justify-center q-mt-lg"},Jt=(0,q.aZ)({props:{linkUrl:{type:String,required:!0},password:{type:String,required:!1}},emits:[...S.Z.emits],setup(e){const t=e,{dialogRef:a,onDialogHide:o,onDialogCancel:i}=(0,S.Z)(),n=i;return(e,i)=>{const l=(0,q.up)("q-separator"),s=(0,q.up)("q-btn"),r=(0,q.up)("q-card-section"),c=(0,q.up)("q-card"),u=(0,q.up)("q-dialog");return(0,q.wg)(),(0,q.j4)(u,{ref_key:"dialogRef",ref:a,onHide:(0,Z.SU)(o)},{default:(0,q.w5)((()=>[(0,q.Wm)(c,{class:"q-dialog-plugin dialog-primary"},{default:(0,q.w5)((()=>[(0,q.Wm)(l),(0,q.Wm)(r,null,{default:(0,q.w5)((()=>[Ft,(0,q._)("div",Kt,(0,x.zw)(t.linkUrl),1),void 0!==t.password?((0,q.wg)(),(0,q.iD)("div",Vt,"分享密码:"+(0,x.zw)(t.password),1)):(0,q.kq)("",!0),(0,q._)("div",Et,[(0,q.Wm)(s,{class:"q-ma-sm",color:"primary",label:"ok",unelevated:"",onClick:(0,Z.SU)(n)},null,8,["onClick"])])])),_:1})])),_:1})])),_:1},8,["onHide"])}}}),Mt=Jt,Yt=Mt;V()(Jt,"components",{QDialog:L.Z,QCard:N.Z,QSeparator:R.Z,QCardSection:A.Z,QBtn:$.Z});var Gt=function(e,t,a,o){function i(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,n){function l(e){try{r(o.next(e))}catch(t){n(t)}}function s(e){try{r(o["throw"](e))}catch(t){n(t)}}function r(e){e.done?a(e.value):i(e.value).then(l,s)}r((o=o.apply(e,t||[])).next())}))};const Xt={loadBucketTable(e){return Gt(this,void 0,void 0,(function*(){e.commit("clearTable",e.state.tables.bucketTable),e.commit("storeStatus",{table:e.state.tables.bucketTable,status:"loading"});const t=yield s.Wh.api.getBuckets();for(const a of t.data.buckets)e.commit("storeItem",{table:e.state.tables.bucketTable,item:{[a.name]:Object.assign(a,{localId:a.name})}});e.commit("storeStatus",{table:e.state.tables.bucketTable,status:"total"})}))},addBucketStatTable(e,t){return Gt(this,void 0,void 0,(function*(){e.commit("storeStatus",{table:e.state.tables.bucketStatTable,status:"loading"});const a=yield s.Wh.api.getStatsBucket({path:{bucket_name:t.bucket}});e.commit("storeItem",{table:e.state.tables.bucketStatTable,item:{[t.bucket]:Object.assign({},{localId:a.data.bucket_name,bucket_name:a.data.bucket_name,stats:a.data.stats,stats_time:a.data.stats_time})}}),e.commit("storeStatus",{table:e.state.tables.bucketStatTable,status:"part"})}))},addBucketTokenTable(e,t){return Gt(this,void 0,void 0,(function*(){e.commit("storeStatus",{table:e.state.tables.bucketTokenTable,status:"loading"});const a=yield s.Wh.api.getBucketsIdOrNameTokenList({query:{"by-name":!0},path:{id_or_name:t.bucket}});e.commit("storeItem",{table:e.state.tables.bucketTokenTable,item:{[t.bucket]:Object.assign({},{localId:t.bucket,bucket_name:t.bucket,tokens:a.data.tokens})}}),e.commit("storeStatus",{table:e.state.tables.bucketTokenTable,status:"part"})}))},addPathTable(e,t){return Gt(this,void 0,void 0,(function*(){if(e.commit("storeStatus",{table:e.state.tables.pathTable,status:"loading"}),t.path){const a=yield s.Wh.api.getDirBucketNameDirPath({path:{bucket_name:t.bucket,dirpath:t.path}});e.commit("storeItem",{table:e.state.tables.pathTable,item:{[t.bucket+"/"+t.path]:Object.assign({},{localId:a.data.bucket_name+"/"+a.data.dir_path,bucket_name:a.data.bucket_name,dir_path:a.data.dir_path,files:a.data.files})}})}else{const a=yield s.Wh.api.getDirBucketName({path:{bucket_name:t.bucket}});e.commit("storeItem",{table:e.state.tables.pathTable,item:{[t.bucket]:Object.assign({},{localId:a.data.bucket_name,bucket_name:a.data.bucket_name,dir_path:a.data.dir_path,files:a.data.files})}})}e.commit("storeStatus",{table:e.state.tables.pathTable,status:"part"})}))},triggerCreateBucketDialog(){_.Z.create({component:J})},triggerCreateFolderDialog(e,t){_.Z.create({component:at,componentProps:{bucket_name:t.dirName}})},triggerDeleteFolderDialog(e,t){_.Z.create({component:rt,componentProps:{bucket_name:t.localId,dirpath:t.dirNames}})},triggerChangeFolderDialog(e,t){_.Z.create({component:Ct,componentProps:{bucket_name:t.localId,objpath:t.dirName}})},triggerPublicShareDialog(e,t){_.Z.create({component:Bt,componentProps:{bucket_name:t.localId,pathObj:t.dirNames}})},triggerAlreadyShareDialog(e,t){_.Z.create({component:zt,componentProps:{bucket_name:t.localId,pathObj:t.dirNames}})},triggerShareLinksDialog(e,t){_.Z.create({component:Yt,componentProps:{linkUrl:t.url,password:t.password}})},triggerUploadDialog(e,t){_.Z.create({component:yt,componentProps:{bucket_name:t.bucket_name}})},triggerDeleteBucketDialog(e,t){_.Z.create({component:se,componentProps:{bucketNames:t.bucketNames}})},triggerEditBucketFtpPasswordDialog(e,t){_.Z.create({component:he,componentProps:{bucketName:t.bucketName,isRo:t.isRo}})},triggerEditBucketNoteDialog(e,t){_.Z.create({component:qe,componentProps:{bucketName:t.bucketName}})},triggerAddBucketTokenDialog(e,t){_.Z.create({component:Pe,componentProps:{bucketName:t.bucketName}})},triggerDeleteBucketTokenDialog(e,t){_.Z.create({component:Ve,componentProps:{bucketName:t.bucketName,token:t.token}})},toggleBucketAccess(e,t){var a;return Gt(this,void 0,void 0,(function*(){const o=yield s.Wh.api.patchBucketsIdOrName({path:{id_or_name:t.bucketName},query:{"by-name":!0,public:"私有"===(null===(a=e.state.tables.bucketTable.byLocalId[t.bucketName])||void 0===a?void 0:a.access_permission)?1:2}});200===o.data.code&&e.commit("storeItemField",{table:e.state.tables.bucketTable,id:t.bucketName,field:"access_permission",value:1===o.data.public?"公有":"私有"})}))},toggleBucketFtp(e,t){var a;return Gt(this,void 0,void 0,(function*(){const o=yield s.Wh.api.patchFtpBucketName({path:{bucket_name:t.bucketName},query:{enable:!0!==(null===(a=e.state.tables.bucketTable.byLocalId[t.bucketName])||void 0===a?void 0:a.ftp_enable)}});200===o.data.code&&e.commit("storeItemField",{table:e.state.tables.bucketTable,id:t.bucketName,field:"ftp_enable",value:o.data.data.enable})}))}},ea=Xt,ta={someGetter(){}},aa=ta,oa={storeItem(e,t){"localId"===t.table.type?(Object.assign(t.table.byLocalId,t.item),t.table.allLocalIds.unshift(Object.keys(t.item)[0]),t.table.allLocalIds=[...new Set(t.table.allLocalIds)]):"id"===t.table.type&&(Object.assign(t.table.byId,t.item),t.table.allIds.unshift(Object.keys(t.item)[0]),t.table.allIds=[...new Set(t.table.allIds)])},storeStatus(e,t){t.table.status=t.status},clearTable(e,t){"localId"===t.type?(t.byLocalId={},t.allLocalIds=[],t.status="empty"):"id"===t.type&&(t.byId={},t.allIds=[],t.status="empty")},deleteItem(e,t){"localId"===t.table.type?(t.table.allLocalIds=t.table.allLocalIds.filter((e=>e!==t.id)),delete t.table.byLocalId[t.id]):"id"===t.table.type&&(t.table.allIds=t.table.allIds.filter((e=>e!==t.id)),delete t.table.byId[t.id])},storeItemField(e,t){"localId"===t.table.type?t.table.byLocalId[t.id][t.field]=t.value:"id"===t.table.type&&(t.table.byId[t.id][t.field]=t.value)},storeSingleFileItem(e,t){"localId"===t.table.type?t.table.byLocalId[t.item.bucket_name].files.unshift(t.item.files):"id"===t.table.type&&t.table.byId[t.item.bucket_name].files.unshift(t.item.files)},changeObjName(e,t){"localId"===t.table.type?t.table.byLocalId[t.item.bucket_name].files.forEach((e=>{e.name===t.item.dirName&&(e.name=t.item.newName)})):"id"===t.table.type&&t.table.byId[t.item.bucket_name].files.forEach((e=>{e.name===t.item.dirName&&(e.name=t.item.newName)}))},deleteFile(e,t){"localId"===t.table.type?(t.item.dirpath.dirArrs.length>0&&(t.table.byLocalId[t.item.bucket_name].files=t.table.byLocalId[t.item.bucket_name].files.filter((e=>!t.item.dirpath.dirArrs.includes(e.name)))),t.item.dirpath.fileArrs.length>0&&(t.table.byLocalId[t.item.bucket_name].files=t.table.byLocalId[t.item.bucket_name].files.filter((e=>!t.item.dirpath.fileArrs.includes(e.name))))):"id"===t.table.type&&(t.item.dirpath.dirArrs.length>0&&(t.table.byId[t.item.bucket_name].files=t.table.byId[t.item.bucket_name].files.filter((e=>!t.item.dirpath.dirArrs.includes(e.name)))),t.item.dirpath.fileArrs.length>0&&(t.table.byId[t.item.bucket_name].files=t.table.byId[t.item.bucket_name].files.filter((e=>!t.item.dirpath.fileArrs.includes(e.name)))))}},ia=oa,na={namespaced:!0,actions:ea,getters:aa,mutations:ia,state:w},la=na,sa=Symbol("vuex-key"),ra=(0,o.h)((function(){const e=(0,i.MT)({modules:{account:y,obs:la},strict:!1});return e}));function ca(){return(0,i.oR)(sa)}},4654:()=>{}},t={};function a(o){var i=t[o];if(void 0!==i)return i.exports;var n=t[o]={exports:{}};return e[o](n,n.exports,a),n.exports}a.m=e,(()=>{var e=[];a.O=(t,o,i,n)=>{if(!o){var l=1/0;for(u=0;u<e.length;u++){for(var[o,i,n]=e[u],s=!0,r=0;r<o.length;r++)(!1&n||l>=n)&&Object.keys(a.O).every((e=>a.O[e](o[r])))?o.splice(r--,1):(s=!1,n<l&&(l=n));if(s){e.splice(u--,1);var c=i();void 0!==c&&(t=c)}}return t}n=n||0;for(var u=e.length;u>0&&e[u-1][2]>n;u--)e[u]=e[u-1];e[u]=[o,i,n]}})(),(()=>{a.n=e=>{var t=e&&e.__esModule?()=>e["default"]:()=>e;return a.d(t,{a:t}),t}})(),(()=>{a.d=(e,t)=>{for(var o in t)a.o(t,o)&&!a.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}})(),(()=>{a.f={},a.e=e=>Promise.all(Object.keys(a.f).reduce(((t,o)=>(a.f[o](e,t),t)),[]))})(),(()=>{a.u=e=>"js/"+e+"."+{12:"e5a97f54",47:"cb0582bb",86:"e8923c19",96:"a090ead6",304:"182079eb",420:"23330139"}[e]+".js"})(),(()=>{a.miniCssF=e=>"css/"+({143:"app",736:"vendor"}[e]||e)+"."+{12:"7ef6e8e5",47:"31d6cfe0",96:"31d6cfe0",143:"0a2d2bd4",736:"7f543020"}[e]+".css"})(),(()=>{a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{var e={},t="iharbor-front:";a.l=(o,i,n,l)=>{if(e[o])e[o].push(i);else{var s,r;if(void 0!==n)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==o||d.getAttribute("data-webpack")==t+n){s=d;break}}s||(r=!0,s=document.createElement("script"),s.charset="utf-8",s.timeout=120,a.nc&&s.setAttribute("nonce",a.nc),s.setAttribute("data-webpack",t+n),s.src=o),e[o]=[i];var m=(t,a)=>{s.onerror=s.onload=null,clearTimeout(p);var i=e[o];if(delete e[o],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach((e=>e(a))),t)return t(a)},p=setTimeout(m.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=m.bind(null,s.onerror),s.onload=m.bind(null,s.onload),r&&document.head.appendChild(s)}}})(),(()=>{a.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{a.p="/front/"})(),(()=>{var e=(e,t,a,o)=>{var i=document.createElement("link");i.rel="stylesheet",i.type="text/css";var n=n=>{if(i.onerror=i.onload=null,"load"===n.type)a();else{var l=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.href||t,r=new Error("Loading CSS chunk "+e+" failed.\n("+s+")");r.code="CSS_CHUNK_LOAD_FAILED",r.type=l,r.request=s,i.parentNode.removeChild(i),o(r)}};return i.onerror=i.onload=n,i.href=t,document.head.appendChild(i),i},t=(e,t)=>{for(var a=document.getElementsByTagName("link"),o=0;o<a.length;o++){var i=a[o],n=i.getAttribute("data-href")||i.getAttribute("href");if("stylesheet"===i.rel&&(n===e||n===t))return i}var l=document.getElementsByTagName("style");for(o=0;o<l.length;o++){i=l[o],n=i.getAttribute("data-href");if(n===e||n===t)return i}},o=o=>new Promise(((i,n)=>{var l=a.miniCssF(o),s=a.p+l;if(t(l,s))return i();e(o,s,i,n)})),i={143:0};a.f.miniCss=(e,t)=>{var a={12:1,47:1,96:1};i[e]?t.push(i[e]):0!==i[e]&&a[e]&&t.push(i[e]=o(e).then((()=>{i[e]=0}),(t=>{throw delete i[e],t})))}})(),(()=>{var e={143:0};a.f.j=(t,o)=>{var i=a.o(e,t)?e[t]:void 0;if(0!==i)if(i)o.push(i[2]);else{var n=new Promise(((a,o)=>i=e[t]=[a,o]));o.push(i[2]=n);var l=a.p+a.u(t),s=new Error,r=o=>{if(a.o(e,t)&&(i=e[t],0!==i&&(e[t]=void 0),i)){var n=o&&("load"===o.type?"missing":o.type),l=o&&o.target&&o.target.src;s.message="Loading chunk "+t+" failed.\n("+n+": "+l+")",s.name="ChunkLoadError",s.type=n,s.request=l,i[1](s)}};a.l(l,r,"chunk-"+t,t)}},a.O.j=t=>0===e[t];var t=(t,o)=>{var i,n,[l,s,r]=o,c=0;if(l.some((t=>0!==e[t]))){for(i in s)a.o(s,i)&&(a.m[i]=s[i]);if(r)var u=r(a)}for(t&&t(o);c<l.length;c++)n=l[c],a.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return a.O(u)},o=self["webpackChunkiharbor_front"]=self["webpackChunkiharbor_front"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var o=a.O(void 0,[736],(()=>a(1644)));o=a.O(o)})();