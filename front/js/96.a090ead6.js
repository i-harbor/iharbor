"use strict";(self["webpackChunkiharbor_front"]=self["webpackChunkiharbor_front"]||[]).push([[96],{5977:(e,a,t)=>{function o(e){return a=>a.length<=e?a:a.substr(0,e)+"..."}t.d(a,{Z:()=>o})},4850:(e,a,t)=>{function o(e,a=2){return t=>t/Math.pow(e,4)>=1?(t/Math.pow(e,4)).toFixed(a)+" TB":t/Math.pow(e,3)>=1?(t/Math.pow(e,3)).toFixed(a)+" GB":t/Math.pow(e,2)>=1?(t/Math.pow(e,2)).toFixed(a)+" MB":t/e>=1?(t/e).toFixed(a)+" KB":t.toFixed(a)+" Byte"}t.d(a,{Z:()=>o})},4096:(e,a,t)=>{t.r(a),t.d(a,{default:()=>xe});var o=t(3673),l=t(1959),s=t(2323),i=t(8880),n=t(4755),d=t(5948),c=t(5977),r=t(4850),p=t(1914),u=t(8825),m=t(9346);function w(){const e=(0,u.Z)();return(a,t)=>{(0,p.Z)(a).then((()=>{e.notify({classes:"notification-primary shadow-15",textColor:"primary",icon:"mdi-checkbox-multiple-marked",message:t?`${m.i18n.global.tc("内容已经复制到剪切板")}`:`${a} ${m.i18n.global.tc("已经复制到剪切板")}`,position:"bottom",closeBtn:!0,multiLine:!1})}))}}const b=(0,o.Uk)(" 复制 "),k=(0,o.Uk)(" 修改 "),g=(0,o.aZ)({props:{password:{type:String,required:!0},isShowBtn:{type:Boolean,required:!1},editAction:{type:String,required:!0},editActionParameter:{type:Object,required:!0}},setup(e){const a=e,t=w(),i=(0,l.iH)(!0);return(e,n)=>{const d=(0,o.up)("q-icon"),c=(0,o.up)("q-tooltip"),r=(0,o.up)("q-btn"),p=(0,o.up)("q-input");return(0,o.wg)(),(0,o.iD)("div",{class:"PasswordInput row justify-start",style:(0,s.j5)({width:23*a.password.length+"px",maxWidth:"300px",minWidth:"32px"})},[(0,o.Wm)(p,{class:"ellipsis","input-style":{width:a.password.length*(i.value?5:8.5)+"px"},"model-value":a.password,readonly:"",borderless:"",dense:"",type:i.value?"password":"text"},{prepend:(0,o.w5)((()=>[(0,o.Wm)(d,{name:i.value?"visibility":"visibility_off",onClick:n[0]||(n[0]=e=>i.value=!i.value)},null,8,["name"])])),append:(0,o.w5)((()=>[(0,o.Wm)(r,{class:(0,s.C_)([a.isShowBtn?"":"invisible","q-px-xs"]),flat:"",color:"primary",icon:"content_copy",size:"sm",onClick:n[1]||(n[1]=e=>(0,l.SU)(t)(a.password,!0))},{default:(0,o.w5)((()=>[(0,o.Wm)(c,null,{default:(0,o.w5)((()=>[b])),_:1})])),_:1},8,["class"]),(0,o.Wm)(r,{class:(0,s.C_)(a.isShowBtn?"":"invisible"),icon:"edit",size:"sm",dense:"",flat:"",color:"primary",onClick:n[2]||(n[2]=t=>e.$store.dispatch(a.editAction,a.editActionParameter))},{default:(0,o.w5)((()=>[(0,o.Wm)(c,null,{default:(0,o.w5)((()=>[k])),_:1})])),_:1},8,["class"])])),_:1},8,["input-style","model-value","type"])],4)}}});var v=t(4260),y=t(4842),_=t(4554),x=t(2165),h=t(8870),f=t(7518),S=t.n(f);const W=(0,v.Z)(g,[["__scopeId","data-v-6826870d"]]),U=W;S()(g,"components",{QInput:y.Z,QIcon:_.Z,QBtn:x.Z,QTooltip:h.Z});const q=e=>((0,o.dD)("data-v-159120dd"),e=e(),(0,o.Cn)(),e),z={class:"BucketTable"},C={class:"row q-gutter-x-md"},B={class:"row items-center q-gutter-sm q-py-sm text-grey"},T={class:"row items-center no-wrap"},Z=q((()=>(0,o._)("div",{class:"col-auto text-bold"},"全部存储桶",-1))),D={class:"row"},Q={class:"col"},F={class:"row items-center no-wrap"},I={class:"col-auto"},P=(0,o.Uk)(" 修改 "),N={class:"column q-gutter-y-xs",style:{width:"100px"}},L={key:0},M={key:1},A={class:"column q-px-none q-pb-md"},V={class:"col-auto row items-center q-gutter-md"},j=q((()=>(0,o._)("div",{class:"col-auto text-grey"}," 存储桶统计信息 ",-1))),E=(0,o.Uk)(" 删除存储桶 "),H={class:"col-auto row items-center q-gutter-lg"},$={class:"col-auto"},O={class:"col-auto"},R={class:"col-auto"},K={class:"column q-px-none q-pt-md"},Y={class:"col-auto row items-center q-gutter-md"},G=q((()=>(0,o._)("div",{class:"col-auto text-grey"}," 存储桶Token ",-1))),J=(0,o.Uk)(" 创建token "),X={key:0},ee={key:1},ae={class:"col-auto"},te={class:"col-auto"},oe={class:"col-auto"},le={class:"col-auto"},se={class:"col-auto"},ie=(0,o.Uk)(" 删除token "),ne=(0,o.aZ)({props:{buckets:{type:Array,required:!0}},setup(e){const a=e,t=(0,n.useStore)(),{locale:p}=(0,d.QT)({useScope:"global"}),u=(0,l.iH)(""),m=e=>{u.value=e},w=()=>{u.value=""},b=(0,l.iH)([]);(0,o.YP)(t.state.obs.tables.bucketTable,(()=>{b.value=[]}));const k=(0,c.Z)(80),g=(0,c.Z)(20),v=(0,r.Z)(1024),y=e=>{e.expand?e.expand=!e.expand:(e.expand=!e.expand,t.dispatch("obs/addBucketStatTable",{bucket:e.row.name}),t.dispatch("obs/addBucketTokenTable",{bucket:e.row.name}))},_=(0,o.Fl)((()=>[{name:"name",label:"zh"===p.value?"存储桶":"Bucket",field:"name",align:"left",headerStyle:"padding: 0 0 0 1px",style:"max-width: 1200px;padding: 15px 0px",classes:""},{name:"creation",label:"zh"===p.value?"创建时间":"Creation Time",field:"creation",align:"left",headerStyle:"padding: 0 0 0 1px",style:"padding: 15px 0px",classes:""},{name:"access",label:"zh"===p.value?"访问权限":"Accessibility",field:"access",align:"left",headerStyle:"padding: 0 0 0 1px",style:"padding: 15px 0px",classes:""},{name:"ftp",label:"zh"===p.value?"FTP状态":"FTP Status",field:"ftp",align:"left",headerStyle:"padding: 0 0 0 1px",style:"padding: 15px 0px",classes:""},{name:"write",label:"zh"===p.value?"读写密码":"Writable Password",field:"write",align:"left",headerStyle:"padding: 0 0 0 1px",style:"padding: 15px 0px; width: 250px;",classes:""},{name:"read",label:"zh"===p.value?"只读密码":"Readonly Password",field:"read",align:"left",headerStyle:"padding: 0 0 0 1px",style:"padding: 15px 0px; width: 250px;",classes:""},{name:"note",label:"zh"===p.value?"备注":"Notes",field:"note",align:"left",headerStyle:"padding: 0 0 0 1px",style:"padding: 15px 0px",classes:""},{name:"operation",label:"zh"===p.value?"操作":"Operations",field:"operation",align:"left",headerStyle:"padding: 0 0 0 1px",style:"padding: 15px 0px; width: 150px;",classes:""}]));return(e,n)=>{const d=(0,o.up)("q-btn"),c=(0,o.up)("q-icon"),r=(0,o.up)("q-breadcrumbs-el"),x=(0,o.up)("q-breadcrumbs"),h=(0,o.up)("q-checkbox"),f=(0,o.up)("q-td"),S=(0,o.up)("q-toggle"),W=(0,o.up)("q-tooltip"),q=(0,o.up)("q-tr"),ne=(0,o.up)("q-separator"),de=(0,o.up)("q-table");return(0,o.wg)(),(0,o.iD)("div",z,[(0,o._)("div",C,[(0,o.Wm)(d,{class:"col-auto",unelevated:"",color:"primary",label:"新建存储桶",onClick:n[0]||(n[0]=e=>(0,l.SU)(t).dispatch("obs/triggerCreateBucketDialog"))}),(0,o.Wm)(d,{class:"col-auto",unelevated:"",color:"primary",label:"删除存储桶",disable:0===b.value.length,onClick:n[1]||(n[1]=e=>(0,l.SU)(t).dispatch("obs/triggerDeleteBucketDialog",{bucketNames:b.value.map((e=>e.name))}))},null,8,["disable"])]),(0,o._)("div",B,[(0,o.Wm)(x,{class:"col-auto text-black"},{separator:(0,o.w5)((()=>[(0,o.Wm)(c,{size:"xs",name:"chevron_right",color:"grey"})])),default:(0,o.w5)((()=>[(0,o.Wm)(r,{to:"/my/bucket"},{default:(0,o.w5)((()=>[(0,o._)("div",T,[(0,o.Wm)(c,{class:"col-auto",size:"xs",color:"yellow-8",name:"mdi-database"}),Z])])),_:1})])),_:1})]),(0,o._)("div",D,[(0,o._)("div",Q,[(0,o.Wm)(de,{class:"",flat:"",square:"","table-header-class":"bg-grey-1 text-grey",rows:a.buckets,columns:(0,l.SU)(_),"row-key":"name","hide-pagination":"",pagination:{rowsPerPage:0},loading:"loading"===(0,l.SU)(t).state.obs.tables.bucketTable.status,"no-data-label":"没有存储桶",selection:"multiple",selected:b.value,"onUpdate:selected":n[2]||(n[2]=e=>b.value=e)},{"header-selection":(0,o.w5)((e=>[(0,o.Wm)(h,{modelValue:e.selected,"onUpdate:modelValue":a=>e.selected=a,dense:"",size:"xs"},null,8,["modelValue","onUpdate:modelValue"])])),body:(0,o.w5)((e=>[(0,o.Wm)(q,{props:e,class:(0,s.C_)(e.expand?"bg-blue-1":""),onMouseenter:a=>m(e.row.name),onMouseleave:w},{default:(0,o.w5)((()=>[(0,o.Wm)(f,{"auto-width":""},{default:(0,o.w5)((()=>[(0,o.Wm)(h,{modelValue:e.selected,"onUpdate:modelValue":a=>e.selected=a,dense:"",size:"xs"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),(0,o.Wm)(f,{key:"name",props:e},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{flat:"",padding:"none","no-caps":"",to:"/my/bucket/file?bucket="+e.row.name},{default:(0,o.w5)((()=>[(0,o._)("div",F,[(0,o.Wm)(c,{class:"col-auto",size:"sm",color:"yellow-8",name:"mdi-database"}),(0,o._)("div",I,(0,s.zw)((0,l.SU)(k)(e.row.name)),1)])])),_:2},1032,["to"])])),_:2},1032,["props"]),(0,o.Wm)(f,{key:"creation",props:e},{default:(0,o.w5)((()=>[(0,o.Uk)((0,s.zw)(new Date(e.row.created_time).toLocaleString((0,l.SU)(p))),1)])),_:2},1032,["props"]),(0,o.Wm)(f,{key:"access",props:e},{default:(0,o.w5)((()=>[(0,o.Wm)(S,{"model-value":"私有"===e.row.access_permission,icon:"lock",color:"primary","keep-color":"",onClick:a=>(0,l.SU)(t).dispatch("obs/toggleBucketAccess",{bucketName:e.row.name})},null,8,["model-value","onClick"]),(0,o.Uk)(" "+(0,s.zw)(e.row.access_permission),1)])),_:2},1032,["props"]),(0,o.Wm)(f,{key:"ftp",props:e},{default:(0,o.w5)((()=>[(0,o.Wm)(S,{"model-value":e.row.ftp_enable,color:"positive","keep-color":"",onClick:a=>(0,l.SU)(t).dispatch("obs/toggleBucketFtp",{bucketName:e.row.name})},null,8,["model-value","onClick"]),(0,o.Uk)(" "+(0,s.zw)(!1===e.row.ftp_enable?"关闭":"开启"),1)])),_:2},1032,["props"]),(0,o.Wm)(f,{key:"write",props:e},{default:(0,o.w5)((()=>[(0,o.Wm)(U,{password:e.row.ftp_password,"is-show-btn":u.value===e.row.name,"edit-action":"obs/triggerEditBucketFtpPasswordDialog","edit-action-parameter":{bucketName:e.row.name,isRo:!1}},null,8,["password","is-show-btn","edit-action-parameter"])])),_:2},1032,["props"]),(0,o.Wm)(f,{key:"read",props:e},{default:(0,o.w5)((()=>[(0,o.Wm)(U,{password:e.row.ftp_ro_password,"is-show-btn":u.value===e.row.name,"edit-action":"obs/triggerEditBucketFtpPasswordDialog","edit-action-parameter":{bucketName:e.row.name,isRo:!0}},null,8,["password","is-show-btn","edit-action-parameter"])])),_:2},1032,["props"]),(0,o.Wm)(f,{key:"note",props:e},{default:(0,o.w5)((()=>[(0,o.Uk)((0,s.zw)((0,l.SU)(g)(e.row.remarks)||"无备注")+" ",1),(0,o.Wm)(d,{class:(0,s.C_)(u.value===e.row.name?"":"invisible"),icon:"edit",size:"sm",dense:"",flat:"",color:"primary",onClick:a=>(0,l.SU)(t).dispatch("obs/triggerEditBucketNoteDialog",{bucketName:e.row.name})},{default:(0,o.w5)((()=>[(0,o.Wm)(W,null,{default:(0,o.w5)((()=>[P])),_:1})])),_:2},1032,["class","onClick"])])),_:2},1032,["props"]),(0,o.Wm)(f,{key:"operation",props:e},{default:(0,o.w5)((()=>[(0,o._)("div",N,[(0,o.Wm)(d,{unelevated:"",dense:"",color:"primary",onClick:a=>y(e),icon:e.expand?"expand_less":"expand_more"},{default:(0,o.w5)((()=>[e.expand?((0,o.wg)(),(0,o.iD)("div",L,"折叠详情")):((0,o.wg)(),(0,o.iD)("div",M,"展开详情"))])),_:2},1032,["onClick","icon"])])])),_:2},1032,["props"])])),_:2},1032,["props","class","onMouseenter"]),(0,o.wy)((0,o.Wm)(q,{props:e,class:"bg-blue-1"},{default:(0,o.w5)((()=>[(0,o.Wm)(f,{"auto-width":""}),(0,o.Wm)(f,{key:"name",class:"text-center",style:{padding:"15px 0px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{name:"subdirectory_arrow_right",size:"sm",color:"grey-7"})])),_:1}),(0,o.Wm)(f,{colspan:"100%",style:{padding:"15px 0px"}},{default:(0,o.w5)((()=>{var a,i,n,c,r;return[(0,o._)("div",A,[(0,o._)("div",V,[j,(0,o.Wm)(d,{class:"col-auto",flat:"",dense:"","no-caps":"",padding:"none",color:"primary",icon:"delete",size:"sm",onClick:a=>(0,l.SU)(t).dispatch("obs/triggerDeleteBucketDialog",{bucketNames:[e.row.name]})},{default:(0,o.w5)((()=>[E])),_:2},1032,["onClick"])]),(0,o._)("div",H,[(0,o._)("div",$," 对象数量: "+(0,s.zw)(null===(a=(0,l.SU)(t).state.obs.tables.bucketStatTable.byLocalId[e.row.name])||void 0===a?void 0:a.stats.count)+" 个 ",1),(0,o._)("div",O," 存储桶体积: "+(0,s.zw)((0,l.SU)(v)((null===(i=(0,l.SU)(t).state.obs.tables.bucketStatTable.byLocalId[e.row.name])||void 0===i?void 0:i.stats.space)||0)),1),(0,o._)("div",R," 统计时间: "+(0,s.zw)(new Date(null===(n=(0,l.SU)(t).state.obs.tables.bucketStatTable.byLocalId[e.row.name])||void 0===n?void 0:n.stats_time).toLocaleString((0,l.SU)(p))),1)])]),(0,o.Wm)(ne),(0,o._)("div",K,[(0,o._)("div",Y,[G,(0,o.Wm)(d,{class:"col-auto",flat:"",dense:"","no-caps":"",padding:"none",color:"primary",icon:"add_circle",size:"sm",onClick:a=>(0,l.SU)(t).dispatch("obs/triggerAddBucketTokenDialog",{bucketName:e.row.name})},{default:(0,o.w5)((()=>[J])),_:2},1032,["onClick"])]),0===(null===(c=(0,l.SU)(t).state.obs.tables.bucketTokenTable.byLocalId[e.row.name])||void 0===c?void 0:c.tokens.length)?((0,o.wg)(),(0,o.iD)("div",X," 暂无可用token ")):((0,o.wg)(),(0,o.iD)("div",ee,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(null===(r=(0,l.SU)(t).state.obs.tables.bucketTokenTable.byLocalId[e.row.name])||void 0===r?void 0:r.tokens,((a,i)=>((0,o.wg)(),(0,o.iD)("div",{key:i,class:"col-auto row items-center q-gutter-lg"},[(0,o._)("div",ae," 序号: "+(0,s.zw)(i+1),1),(0,o._)("div",te," token: "+(0,s.zw)(a.key),1),(0,o._)("div",oe," 权限: "+(0,s.zw)("readwrite"===a.permission?"读写":"只读"),1),(0,o._)("div",le," 创建时间: "+(0,s.zw)(new Date(a.created).toLocaleString((0,l.SU)(p))),1),(0,o._)("div",se,[(0,o.Wm)(d,{class:"col-auto",flat:"",dense:"","no-caps":"",padding:"none",color:"primary",icon:"remove_circle",size:"sm",onClick:o=>(0,l.SU)(t).dispatch("obs/triggerDeleteBucketTokenDialog",{bucketName:e.row.name,token:a.key})},{default:(0,o.w5)((()=>[ie])),_:2},1032,["onClick"])])])))),128))]))])]})),_:2},1024)])),_:2},1032,["props"]),[[i.F8,e.expand]])])),_:1},8,["rows","columns","loading","selected"]),(0,o.Wm)(ne)])])])}}});var de=t(1481),ce=t(5926),re=t(6429),pe=t(5735),ue=t(8186),me=t(3884),we=t(8886),be=t(5869);const ke=(0,v.Z)(ne,[["__scopeId","data-v-159120dd"]]),ge=ke;S()(ne,"components",{QBtn:x.Z,QBreadcrumbs:de.Z,QIcon:_.Z,QBreadcrumbsEl:ce.Z,QTable:re.Z,QCheckbox:pe.Z,QTr:ue.Z,QTd:me.Z,QToggle:we.Z,QTooltip:h.Z,QSeparator:be.Z});const ve={class:"Bucket"},ye=(0,o.aZ)({setup(e){const a=(0,n.useStore)();a.dispatch("obs/loadBucketTable");const t=(0,o.Fl)((()=>Object.values(a.state.obs.tables.bucketTable.byLocalId).sort(((e,a)=>e.name.localeCompare(a.name,"en")))));return(e,a)=>((0,o.wg)(),(0,o.iD)("div",ve,[(0,o.Wm)(ge,{buckets:(0,l.SU)(t)},null,8,["buckets"])]))}}),_e=(0,v.Z)(ye,[["__scopeId","data-v-24016858"]]),xe=_e}}]);